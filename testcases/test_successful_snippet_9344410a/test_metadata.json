{
  "cobol_file": {
    "file_name": "successful_snippet_9344410a.cob",
    "content": "      *************************************************************\n      * The purpose of this program is to produce a detail report *\n      * of sales and list the sales and the layaway.               * \n      * ***********************************************************\n\n       identification division.\n       program-id. S-LProcessingReport.\n\n       author. Mohammad AL Jarrah Paul Kerrigan.\n       date-written. 2018-04-15.\n\n\n       environment division.\n       configuration section.\n       input-output section.\n\n       file-control.\n\n      * configure input file\n\n           select input-file\n               assign to \"SL.out\"\n               organization is line sequential.\n                    \n      * configure output file\n       \n           select output-file\n               assign to \"SLProcessing.out\"\n               organization is line sequential.\n\n       data division.\n       file section.\n\n      *declare the input files and record definition\n\n       fd input-file\n           data record is input-line\n           record contains 36 characters.\n\n       01 input-line.\n           05 il-transaction-code                  pic x.\n           05 il-transaction-amount                pic 9(5)v99.\n           05 il-payment-type                      pic xx.\n           05 il-store-number                      pic 99.\n           05 il-invoice-number                    pic x(9).\n           05 il-sku-code                          pic x(15).\n\n      *declare the output files and record definition \n\n       fd output-file\n           data record is output-line\n               record contains 120 characters.\n\n      *declare grad file\n       01 output-line                              pic x(120).\n\n       working-storage section.\n\n       01 ws-flags.\n           05 ws-eof-flag                          pic x\n               value 'N'.\n\n      * create headings \n       01 ws-heading-line1.\n           05 filler                               pic x(30)\n               value spaces.\n           05 filler                               pic x(21)\n               value \"S&L PROCESSING REPORT\".\n           05 filler                               pic x(19)\n               value spaces.\n           05 filler                               pic x(5)\n               value \"PAGE \". \n           05 ws-ol-page-num                       pic 9\n               value 1.\n           05 filler                               pic xxx\n               value spaces.\n\n       01 ws-heading-line2.\n           05 filler                               pic x\n               value spaces.\n           05 filler                               pic x(11)\n               value \"TRANSACTION\".\n           05 filler                               pic xx\n               value spaces.\n           05 filler                               pic x(11)\n               value \"TRANSACTION\".        \n           05 filler                               pic xx\n               value spaces.\n           05 filler                               pic x(7)\n               value \"PAYMENT\".\n           05 filler                               pic xx\n               value spaces.\n           05 filler                               pic x(5)\n               value \"STORE\".\n           05 filler                               pic xxx\n               value spaces.       \n           05 filler                               pic x(7)\n               value \"INVOICE\".\n           05 filler                               pic x(10)\n               value spaces.\n           05 filler                               pic x(3)\n               value \"SKU\".\n           05 filler                               pic x(15)\n               value spaces.   \n           05 filler                               pic x(3)\n               value \"TAX\".\n\n\n       01 ws-heading-line3.\n           05  filler                              pic x(4)\n               value spaces.\n           05  filler                              pic x(4)\n               value \"CODE\".\n           05  filler                              pic x(8)\n               value spaces.\n           05  filler                              pic x(6)\n               value \"AMOUNT\".\n           05  filler                              pic x(5)\n               value spaces.\n           05  filler                              pic x(4)\n               value \"TYPE\".\n           05  filler                              pic x(5)\n               value spaces.\n           05  filler                              pic x(6)\n               value \"NUMBER\".\n           05  filler                              pic xx\n               value spaces.\n           05  filler                              pic x(6)\n               value \"NUMBER\".\n           05  filler                              pic x(11)\n               value spaces.\n           05  filler                              pic x(4)\n               value \"CODE\".\n           05  filler                              pic x(13)\n               value spaces.\n           05  filler                              pic x(5)\n               value \"OWING\".\n\n\n       01 ws-underlines.\n           05  filler                              pic x\n               value spaces.\n           05  filler                              pic x(11)\n               value \"-----------\".\n           05  filler                              pic xx\n               value spaces.\n           05  filler                              pic x(11)\n               value \"-----------\".\n           05  filler                              pic xx\n               value spaces.\n           05  filler                              pic x(7)\n               value \"-------\".\n           05  filler                              pic xx\n               value spaces.\n           05  filler                              pic x(6)\n               value \"------\".\n           05  filler                              pic xx\n               value spaces.\n           05  filler                              pic x(7)\n               value \"-------\".\n           05  filler                              pic x(10)\n               value spaces.\n           05  filler                              pic x(4)\n               value \"----\".\n           05  filler                              pic x(13)\n               value spaces.\n           05  filler                              pic x(5)\n               value \"-----\".\n\n      *create details line to output records on report\n       01 ws-detail-line.\n           05 filler                               pic x(5)\n               value spaces.\n           05 ws-ol-transaction-code               pic x.\n           05 filler                               pic x(8)\n               value spaces.\n           05 ws-ol-transaction-amount             pic $$$$,$$9.99.\n           05 filler                               pic x(4)\n               value spaces.\n           05 ws-ol-payment-type                   pic xx.\n           05 filler                               pic x(7)\n               value spaces.\n           05 ws-ol-store-number                   pic z9.\n           05 filler                               pic x(4)\n               value spaces.\n           05 ws-ol-invoice-number                 pic x(9).\n           05 filler                               pic x(4)\n               value spaces.\n           05 ws-ol-sku-code                       pic x(15).\n           05 filler                               pic x\n               value spaces.\n           05 ws-ol-tax-owing                      pic $$$$9.99.\n\n      *calculate total number of S and total amount S records\n       01 ws-totals-for-s-redords.\n           05 filler                               pic x\n               value spaces.\n           05 filler                               pic x(29)\n               value \"TOTAL NUMBER OF 'S' RECORDS: \".\n           05 filler                               pic x\n               value spaces.\n           05 ws-ol-tot-num-s-records              pic 99.\n           05 filler                               pic x(10)\n               value spaces.\n           05 filler                               pic x(29)\n               value \"TOTAL AMOUNT OF 'S' RECORDS: \".\n           05 ws-ol-tot-amount-s-records           pic $$$$,$$9.99.\n\n\n\n      *calculate total number of L and total amount L records\n       01 ws-totals-for-l-redords.\n           05 filler                               pic x\n               value spaces.\n           05 filler                               pic x(29)\n               value \"TOTAL NUMBER OF 'L' RECORDS: \".\n           05 filler                               pic x\n               value spaces.\n           05 ws-ol-tot-num-l-records              pic 99.\n           05 filler                               pic x(10)\n               value spaces.\n           05 filler                               pic x(29)\n               value \"TOTAL AMOUNT OF 'L' RECORDS: \".\n           05 ws-ol-tot-amount-l-records           pic $$$$,$$9.99.\n      *    05 ws-ol-ws-tot-amount-cash           pic zzzz,zz9.99.\n\n\n      *calculate the percntag of each payment type \n       01 ws-percntg-of-each-payment-type.\n           05 filler                               pic x\n               value spaces.\n           05 filler                               pic x(37)\n               value \"THE PERCENTAGE OF EACH PAYMENT TYPE: \".\n           05 filler                               pic x\n               value spaces.\n           05 filler                               pic x(12)\n               value \"CASH 'CA' = \".\n           05 ws-ol-tot-percntg-cash               pic 99.99.\n           05 ws-ol-percnt-sign1                   pic x.\n           05 filler                               pic xxx\n               value spaces.\n           05 filler                               pic x(19)\n               value \"CREDIT CARD 'CR' = \".\n           05 ws-ol-tot-percntg-credit             pic 99.99.\n           05 ws-ol-percnt-sign2                   pic x.\n           05 filler                               pic xxx\n               value spaces.\n           05 filler                               pic x(13)\n               value \"DEBIT 'DB' = \".\n           05 ws-ol-tot-percntg-debit              pic 99.99.\n           05 ws-ol-percnt-sign3                   pic x.\n\n\n      *calculate the total for tax owing\n       01 ws-total-tax-owing.\n           05 filler                               pic x\n               value spaces.\n           05 filler                               pic x(17)\n               value \"TOTAL TAX OWING: \".\n           05 filler                               pic x\n               value spaces.\n           05 ws-ol-tot-tax-owing                  pic $$$,$$9.99.\n          \n      *determine the store number with the highest S&L transaction amont\n       01 ws-store-num-highst-trans-amount.\n           05 filler                               pic x\n               value spaces.\n           05 filler                               pic x(14)\n               value \"STORE NUMBER (\".\n           05 ws-ol-store-num-highest-amount       pic z9\n               value 0.\n           05 filler                               pic x(34)\n               value \" ) HAS HIGHEST TRANSACTION AMOUNT.\".\n           \n       \n       01 ws-test1.\n           05 ws-sub-total                         pic 99\n               value 0.\n           05 ws-tot-store-amount                  pic 9(6)v99\n                                                   occurs 8 times\n                                                   value 0.\n\n       \n\n      *set values\n       77 ws-sales                                 pic x\n           value \"S\". \n       77 ws-layaway                               pic x\n           value \"L\".\n\n       77 ws-payment-cash                          pic xx\n           value \"CA\".\n       77 ws-payment-credit                        pic xx\n           value \"CR\". \n       77 ws-payment-debit                         pic xx\n           value \"DB\".\n\n       77 ws-line-break                            pic x(99)\n           value spaces.\n       77 ws-page-num                              pic 9\n           value 2.\n       77 ws-line-count                            pic 99\n           value 0. \n       77 ws-lines-per-page                        pic 99\n           value 20.\n\n       77 ws-tax-owing                             pic 9(5)v99\n           value 0.\n       77 ws-tax-value                             pic 9v99\n           value 0.13.\n       77 ws-tot-num-s-records                     pic 99\n           value 0.\n       77 ws-tot-amount-s-records                  pic 9(6)v99\n           value 0.\n       77 ws-tot-num-l-records                     pic 99\n           value 0.\n       77 ws-tot-amount-l-records                  pic 9(6)v99\n           value 0.\n       77 ws-overall-tot-amount                    pic 9(5)v99\n           value 0.\n\n       01 ws-tot-num-cash                          pic 99\n           value 0.\n       01 ws-tot-num-credit                        pic 99\n           value 0.\n       01 ws-tot-num-debit                         pic 99\n           value 0.\n       01 ws-count                                 pic 999\n           value 0.\n\n       01 ws-tot-amount-cash                       pic 999v9999\n           value 0.\n       01 ws-tot-amount-credit                     pic 999v9999\n           value 0.\n       01 ws-tot-amount-debit                      pic 999v9999\n           value 0.\n\n       01 ws-tot-prcnt-cash                        pic 999v999\n           value 0.\n       01 ws-tot-prcnt-credit                      pic 999v999\n           value 0.\n       01 ws-tot-prcnt-debit                       pic 999v999\n           value 0.\n\n       77 ws-tot-tax-owing                         pic 9(5)v99\n           value 0.\n\n       01 ws-save-amt                              pic 9(6)v99\n           value 0.\n       01 ws-sub                                   pic 99\n           value 0.\n       procedure division.\n       000-main.\n\n           open input  input-file.\n           open output output-file.\n\n      * read initial record from input-file\n           read input-file\n               at end move \"Y\"\n                   to ws-eof-flag.\n\n           perform 100-print-headings.\n\n           perform 200-process-page\n               until ws-eof-flag = \"Y\".\n\n           write output-line       from ws-totals-for-s-redords\n           after advancing 2 lines.\n\n           write output-line       from ws-totals-for-l-redords\n           after advancing 2 lines.\n\n           write output-line       from ws-percntg-of-each-payment-type\n           after advancing 2 line.\n\n           write output-line       from ws-total-tax-owing\n           after advancing 2 line.\n\n           write output-line       from ws-store-num-highst-trans-amount\n           after advancing 2 lines.\n           \n      * close files\n           close   input-file.\n           close   output-file.\n           goback.\n       \n       100-print-headings.\n\n           write output-line                from ws-heading-line1.\n           write output-line                from ws-heading-line2\n               after advancing 1 lines.\n           write output-line                from ws-heading-line3.\n           write output-line                from ws-underlines.\n       \n       200-process-page.\n\n           move spaces                      to ws-detail-line.\n           move ws-page-num                 to ws-ol-page-num.\n           move il-transaction-code         to ws-ol-transaction-code.\n           move il-transaction-amount       to ws-ol-transaction-amount.\n           move il-payment-type             to ws-ol-payment-type.\n           move il-store-number             to ws-ol-store-number.\n           move il-invoice-number           to ws-ol-invoice-number.\n           move il-sku-code                 to ws-ol-sku-code.\n           move ws-tot-num-s-records        to ws-ol-tot-num-s-records.\n           move ws-tot-num-l-records        to ws-ol-tot-num-l-records.\n           move \"%\"                         to ws-ol-percnt-sign1.\n           move \"%\"                         to ws-ol-percnt-sign2.\n           move \"%\"                         to ws-ol-percnt-sign3.\n\n      *    perform 300-calculations.\n           \n      *calculate the totals for 'S' and 'L' records\n           if ws-line-count >= ws-lines-per-page  then\n\n               write output-line            from ws-heading-line1\n                   after advancing 3 lines\n               write output-line            from ws-heading-line2\n                   after advancing 2 lines\n               write output-line            from ws-heading-line3\n               write output-line            from ws-underlines\n               write output-line            from ws-line-break\n\n               move 0                       to ws-line-count\n               add 1                        to ws-page-num\n           end-if.\n\n\n           if il-transaction-code = ws-sales      then\n             compute ws-tot-amount-s-records        rounded = \n             ws-tot-amount-s-records + il-transaction-amount\n       \n             move ws-tot-amount-s-records\n             to ws-ol-tot-amount-s-records\n\n               \n               add 1                           to ws-tot-num-s-records\n               add 1                           to ws-line-count\n               add 1                           to ws-count\n               perform 400-calc-percentage-of-each-payment-type\n               compute ws-tax-owing rounded = \n               il-transaction-amount * ws-tax-value\n               move ws-tax-owing               to ws-ol-tax-owing\n               write output-line               from ws-detail-line\n           else\n           \n           if il-transaction-code = ws-layaway    then\n             compute ws-tot-amount-l-records        rounded = \n             ws-tot-amount-l-records + il-transaction-amount\n                                        \n             move ws-tot-amount-l-records\n             to ws-ol-tot-amount-l-records\n\n               \n\n               add 1                           to ws-line-count\n               add 1                           to ws-tot-num-l-records\n               add 1                           to ws-count\n               perform 400-calc-percentage-of-each-payment-type\n               compute ws-tax-owing rounded = \n               il-transaction-amount * ws-tax-value\n               move ws-tax-owing               to ws-ol-tax-owing\n               write output-line               from ws-detail-line\n           end-if\n           end-if.\n\n           compute ws-overall-tot-amount          rounded = \n               ws-tot-amount-s-records + ws-tot-amount-l-records.\n           \n           \n\n          \n           read input-file \n               at end move \"Y\"\n                   to ws-eof-flag.\n\n\n       300-calculations.\n\n      *calculate the tax owing amount \n           compute ws-tax-owing rounded = \n             il-transaction-amount * ws-tax-value.\n           move ws-tax-owing                   to ws-ol-tax-owing.\n\n      *calculate the percentage of each payment type\n       400-calc-percentage-of-each-payment-type.\n           if il-payment-type = ws-payment-cash         then \n               add 1                           to ws-tot-num-cash       \n               compute ws-tot-amount-cash rounded =\n                   (ws-tot-num-cash / ws-count) \n               compute ws-tot-prcnt-cash  rounded = \n                   ws-tot-amount-cash * 100\n               move ws-tot-prcnt-cash        to ws-ol-tot-percntg-cash\n               \n           else\n           if il-payment-type = ws-payment-credit       then \n               add 1 to ws-tot-num-credit\n               compute ws-tot-amount-credit rounded = \n                   (ws-tot-num-credit / ws-count) \n               compute ws-tot-prcnt-credit  rounded = \n                   ws-tot-amount-credit * 100\n               move ws-tot-prcnt-credit to ws-ol-tot-percntg-credit\n           else\n           if il-payment-type = ws-payment-debit        then \n               add 1 to ws-tot-num-debit       \n               compute ws-tot-amount-debit rounded = \n                    (ws-tot-num-debit / ws-count) \n               compute ws-tot-prcnt-debit  rounded = \n                 ws-tot-amount-debit * 100\n               move ws-tot-prcnt-debit to ws-ol-tot-percntg-debit\n           end-if\n           end-if\n           end-if.\n\n           \n\n      *cslculate the total for tax owing\n           compute ws-tot-tax-owing                rounded =\n             ws-tax-owing + ws-tot-tax-owing.\n\n           move ws-tot-tax-owing      to ws-ol-tot-tax-owing.\n\n      *determine the store number with the highest S&L transaction amont\n           move il-store-number       to ws-sub-total.\n           add il-transaction-amount          \n             to ws-tot-store-amount (ws-sub-total).\n           add il-transaction-amount  to ws-tot-store-amount (8).\n           \n           move 0 to ws-save-amt.\n           perform varying ws-sub-total from 1 by 1\n             until ws-sub-total = 8\n\n               if ws-tot-store-amount(ws-sub-total) > ws-save-amt then\n                   move ws-tot-store-amount(ws-sub-total) to ws-save-amt\n                   move ws-sub-total to ws-sub\n               end-if\n           end-perform.\n           move ws-sub to ws-ol-store-num-highest-amount.\n       end program S-LProcessingReport."
  },
  "input_files": [
    {
      "file_name": "SL.out",
      "content": "S0125099CA02SKU-ELEC-78945\nL0089550DB07SKU-HOME-12367\nS0034275CA03SKU-TOYS-45612\nR0067800CC02SKU-CLTH-89034\nS0015620DB02SKU-FOOD-23456\nL0156340CA07SKU-SPRT-67890\nS0028915CC03SKU-BOOK-11223\nL0198765DB02SKU-FURN-99887\nS0045580CA07SKU-GARD-44556\nR0023450CC03SKU-ELEC-78901"
    }
  ],
  "output_files": [
    "SLProcessing.out"
  ],
  "input_output_files": [],
  "sysin_file": null
}