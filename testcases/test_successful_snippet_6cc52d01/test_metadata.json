{
  "cobol_file": {
    "file_name": "successful_snippet_6cc52d01.cob",
    "content": "000010 @OPTIONS MAIN,TEST\n000020 Identification Division.\n000030 Program-Id.  Chapt18x.\n000031* Chapter 18 Exercise Solution\n000043 Environment Division.\n000050 Configuration Section.\n000055 Source-Computer.  IBM-PC.\n000056 Object-Computer.  IBM-PC.\n000061 Input-Output  Section.\n000062 File-Control.\n000063     Select Optional Trans-File Assign To \"Trans.Seq\"\n000064         Organization Is Line Sequential.\n000066     Select Optional Dealer-File Assign To \"Dealer.Seq\"\n000067         Organization Is Line Sequential.\n000068     Select Optional Dealer-Out Assign To \"Dealer.Out\"\n000069         Organization Is Line Sequential.\n000073 Data Division.\n000074 File Section.\n000075 Fd  Trans-File.\n000076 01  Trans-Record.\n000077     03  Transaction-Date   Pic  9(8).\n000078     03  Transaction-Text.\n000079         05  Transaction-Type   Pic  X(4).\n000080         05  Transaction-Dealer Pic  X(8).\n000081     03  Transaction-Price  Pic S9(7)v99.\n000082     03  Transaction-Qty    Pic  9(3).\n000083     03  Filler             Pic  X(40).\n000093 Fd  Dealer-File.\n000094 01  Dealer-Record.\n000095     03  Dealer-Number         Pic X(8).\n000096     03  Dealer-Name.\n000097         05  Last-Name   Pic X(25).\n000098         05  First-Name  Pic X(15).\n000099         05  Middle-Name Pic X(10).\n000100     03  Address-Line-1      Pic X(50).\n000101     03  Address-Line-2      Pic X(50).\n000102     03  City                Pic X(40).\n000103     03  State-Or-Country    Pic X(20).\n000104     03  Postal-Code         Pic X(15).\n000105     03  Home-Phone          Pic X(20).\n000106     03  Work-Phone          Pic X(20).\n000107     03  Other-Phone         Pic X(20).\n000108     03  Start-Date          Pic 9(8).\n000109     03  Last-Rent-Paid-Date Pic 9(8).\n000110     03  Next-Rent-Due-Date  Pic 9(8).\n000111     03  Rent-Amount         Pic 9(4)v99.\n000112     03  Consignment-Percent Pic 9(3).\n000113     03  Last-Sold-Amount    Pic S9(7)v99.\n000114     03  Last-Sold-Date      Pic 9(8).\n000115     03  Sold-To-Date        Pic S9(7)v99.\n000116     03  Commission-To-Date  Pic S9(7)v99.\n000117     03  Filler              Pic X(15).\n000118 Fd  Dealer-Out.\n000119 01  Dealer-Out-Record       Pic X(376).\n000144 Working-Storage Section.\n000145 01  Current-Commission      Pic S9(7)v99 Value Zeros.\n000146 01  Total-Commission        Pic S9(7)v99 Value Zeros.\n000154 01  Transactions-Read       Pic 9(5) Value Zeros.\n000165 01  Master-Records-Written  Pic 9(5) Value Zeros.\n000174 01  Work-Date.\n000184     03  Work-MM             Pic 9(2).\n000194     03  Work-DD             Pic 9(2).\n000195     03  Work-YYYY           Pic 9(4).\n000196 01  Reverse-Date.\n000197     03  Work-YYYY           Pic 9(4).\n000198     03  Work-MM             Pic 9(2).\n000199     03  Work-DD             Pic 9(2).\n000200 01  Compare-Date-1          Pic 9(8).\n000201 01  Compare-Date-2          Pic 9(8).\n000204 01  Edit-Count              Pic ZZ,ZZ9.\n000205 01  Edit-Amt                Pic Z,ZZZ,ZZZ.99-.\n000206* Serves As A Hold Area\n000207 01  Hold-Record             Pic X(376).\n000208* This Way We Know We Have A Master Record Held\n000209 01  Create-Flag             Pic X Value Spaces.\n000210     88  Creating-New-Master Value \"Y\".\n000216 Procedure Division.\n000232 Chapt18x-Start.\n000233     Display \"Begin Process Chapt18x\"\n000234     Open Output Dealer-Out\n000236          Input  Trans-File\n000245                 Dealer-File\n000246     Perform Read-Dealer\n000247     Perform Read-Trans\n000255     Perform Process-Files Until\n000265             Trans-Record = High-Values And\n000275             Dealer-Record = High-Values\n000285     Close Dealer-Out\n000305           Trans-File\n000315           Dealer-File\n000316     Move Transactions-Read To Edit-Count\n000317     Display \"Processing Complete\"\n000318     Display \"Transactions Read \" Edit-Count\n000319     Move Master-Records-Written To Edit-Count\n000320     Display \"Master Records Written \" Edit-Count\n000323     Move Total-Commission To Edit-Amt\n000324     Display \"Total Commission  \" Edit-Amt\n000325     Stop Run\n000326     .\n000327\n000335 Process-Files.\n000345     Evaluate True\n000355       When Dealer-Number < Transaction-Dealer\n000365            Perform Write-Dealer-Out\n000375            Perform Read-Dealer\n000385       When Dealer-Number > Transaction-Dealer\n000395            Perform Create-New-Master\n000425            Perform Read-Trans\n000435       When Dealer-Number = Transaction-Dealer\n000445            Perform Apply-Transaction\n000465            Perform Read-Trans\n000475     End-Evaluate\n000485     .\n000495 Apply-Transaction.\n000505     Compute Sold-To-Date = Sold-To-Date +\n000525             (Transaction-Qty * Transaction-Price)\n000526     Compute Current-Commission Rounded =\n000527             (Transaction-Qty * Transaction-Price) *\n000528             (Consignment-Percent / 100)\n000529     Add Current-Commission To Commission-To-Date\n000530                               Total-Commission\n000531     Move Last-Sold-Date To Work-Date\n000532     Move Corresponding Work-Date To Reverse-Date\n000533     Move Reverse-Date To Compare-Date-1\n000534     Move Transaction-Date To Work-Date\n000535     Move Corresponding Work-Date To Reverse-Date\n000536     Move Reverse-Date To Compare-Date-2\n000537     If Compare-Date-2 > Compare-Date-1\n000538        Move Transaction-Date To\n000539             Last-Sold-Date\n000540     End-If\n000541     .\n000542 Write-Dealer-Out.\n000543     Add 1 To Master-Records-Written\n000552     Write Dealer-Out-Record From Dealer-Record\n000562     .\n000563 Create-New-Master.\n000564     Set Creating-New-Master To True\n000565* Move The Current Dealer Master To A Hold Area\n000566     Move Dealer-Record To Hold-Record\n000567* Fill In The Few Basic Fields We Know\n000568     Initialize Dealer-Record\n000569     Move Transaction-Dealer To Dealer-Number\n000570                                Last-Name\n000571* 10 Percent Default Consignment Percent\n000572     Move 10 To Consignment-Percent\n000573* Apply The Transaction Like Any Other\n000574     Perform Apply-Transaction\n000575     .\n000576 Read-Dealer.\n000577* Before Reading, See If A Record Is \"held\", If So, Move It In\n000578* Instead Of Reading A New Record.\n000579* Then Reset The Flag, Because One Is No Longer Held.\n000580     If Creating-New-Master\n000581        Move Hold-Record To Dealer-Record\n000582        Move Space To Create-Flag\n000583     Else\n000584        Read Dealer-File\n000592             At End\n000602             Move High-Values To Dealer-Record\n000612        End-Read\n000613     End-If\n000622     .\n000632 Read-Trans.\n000642     Read Trans-File\n000652          At End\n000662             Move High-Values To Trans-Record\n000663          Not At End\n000664             Add 1 To Transactions-Read\n000672     End-Read\n000682     .\n"
  },
  "input_files": [
    {
      "file_name": "Trans.Seq",
      "content": "20240115SALE12345678000125000050                                        \nD0000001Smith                    John           Robert    123 Main Street                                   Suite 200                                         Springfield                             IL      \n20240116PURC23456789000089950025                                        \nD0000002Johnson                  Mary           Elizabeth 456 Oak Avenue                                   Apt 5B                                            Chicago                                 IL      \n20240117SALE34567890000215000100                                        \nD0000003Williams                 Robert         James     789 Elm Street                                    Building C                                        Peoria                                  IL      \n20240118RETN12345678000125000010                                        \n20240119PURC45678901000156750075                                        \nD0000004Brown                    Patricia       Ann       321 Pine Road                                     Unit 12                                           Rockford                                IL      \n20240120SALE56789012000098500150                                        \nD0000005Davis                    Michael        Thomas    654 Maple Drive                                   Floor 3                                           Naperville                              IL      \n20240121PURC67890123000267800200                                        \nD0000006Miller                   Jennifer       Marie     987 Cedar Lane                                    Office 401                                        Aurora                                  IL      \n20240122SALE78901234000178900125"
    },
    {
      "file_name": "Dealer.Seq",
      "content": "D001    Smith                    John           Robert    123 Main Street                                   Suite 200                                         New York                                NY\nD002    Johnson                  Mary           Elizabeth 456 Oak Avenue                                  Building B                                        Chicago                                 IL\nD003    Williams                 Robert         James     789 Pine Boulevard                                                                                  Los Angeles                             CA\nD004    Brown                    Jennifer       Marie     321 Elm Street                                    Apartment 5C                                      Houston                                 TX\nD005    Davis                    Michael        Thomas    654 Maple Drive                                                                                     Phoenix                                 AZ\nD006    Miller                   Sarah          Ann       987 Cedar Lane                                    Unit 12                                           Philadelphia                            PA\nD007    Wilson                   David          Lee       147 Birch Road                                    Floor 3                                           San Antonio                             TX\nD008    Moore                    Lisa           Grace     258 Spruce Court                                                                                    San Diego                               CA\nD009    Taylor                   James          Patrick   369 Walnut Avenue                                 Suite 450                                         Dallas                                  TX\nD010    Anderson                 Patricia       Lynn      741 Hickory Street                                Building A                                        San Jose                                CA"
    },
    {
      "file_name": "Dealer.Out",
      "content": "ADDL12345678\nJohnson                  Robert         M         \nADDL23456789\nMartinez                 Maria          Elena     \nADDL34567890\nChen                     David          Wei       \nADDL45678901\nO'Brien                  Katherine      Anne      \nADDL56789012\nPatel                    Rajesh         Kumar     \nADDL67890123\nWilliams                 Jennifer       Lynn      \nADDL78901234\nAnderson                 Michael        James     \nADDL89012345\nThompson                 Sarah          Marie"
    }
  ],
  "output_files": [],
  "input_output_files": [],
  "sysin_file": null
}