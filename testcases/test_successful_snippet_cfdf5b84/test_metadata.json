{
  "cobol_file": {
    "file_name": "successful_snippet_cfdf5b84.cob",
    "content": "       identification division.\n       program-id. DataSplit.\n       author. Henry Zheng Paul Kerrigan. \n       date-written. 2018-04-15.\n      * Purpose: Process the valid data and split the records into 2\n      *          files and count\n\n       environment division.\n       configuration section.\n\n       input-output section.\n       file-control.\n      *configure input file\n           select input-file\n               assign to \"valid.out\"\n               organization is line sequential.\n\n      * configure output file\n           select SL-RECORDS-DATA-FILE \n               assign to \"SL.out\"\n               organization is line sequential.\n\n      * configure output file\n           select RETURN-RECORDS-DATA-FILE \n               assign to \"returns.out\"\n               organization is line sequential.\n\n      * configure output file\n           select COUNTS-RECORDS-FILE \n               assign to \"counts.out\"\n               organization is line sequential.\n\n       data division.\n       file section.   \n      * declare an input record definition\n       fd input-file\n           data record is input-line\n           record contains 36 characters.\n\n       01 input-line.\n           05 il-transaction-code              pic x.\n           05 il-transaction-amount            pic 9(5)V99.\n           05 il-payment-type                  pic xx.\n           05 il-store-number                  pic 99.\n           05 il-invoice-number.\n               10 invoice-number-1             pic xx.\n               10 invoice-number-2             pic x.\n               10 invoice-number-3             pic 9(6).\n           05 il-SKU-code                      pic x(15).\n\n      * declare an output record definition\n       fd SL-RECORDS-DATA-FILE\n           data record is SL-line\n           record contains 80 characters.\n\n       01 SL-line                              pic x(80).\n\n       fd RETURN-RECORDS-DATA-FILE\n           data record is R-line\n           record contains 36 characters.\n       \n       01 R-line                               pic x(80).\n       \n       fd COUNTS-RECORDS-FILE\n           data record is C-Line\n           record contains 80 characters.\n\n       01 C-Line                               pic x(80).\n       working-storage section.\n      * General storage section\n        \n      * end of file flag \n       77  ws-eof                              pic x\n           value \"N\".\n\n       77 ws-newline                           pic x\n           value spaces.\n\n      * SL storage section\n       01 ws-sale-count                        pic 999\n           value 0.\n       01 ws-sale-tamount                      pic 9(6)V99\n           value 0.\n       01 ws-layaway-count                     pic 999\n           value 0.\n       01 ws-layaway-tamount                   pic 9(6)V99\n           value 0.\n       01 ws-SL-store-01-tamount               pic 9(6)V99\n           value 0.\n       01 ws-SL-store-02-tamount               pic 9(6)V99\n           value 0.\n       01 ws-SL-store-03-tamount               pic 9(6)V99\n           value 0.\n       01 ws-SL-store-07-tamount               pic 9(6)V99\n           value 0.\n\n       01 ws-SL-tamount                        pic 9(6)V99\n           value 0.\n      * Return storage section\n       01 ws-return-count                      pic 999\n           value 0.\n       01 ws-return-tamount                    pic 9(6)V99\n           value 0.\n\n       01 ws-R-store-01-tamount                pic 9(6)V99\n           value 0.\n       01 ws-R-store-02-tamount                pic 9(6)V99\n           value 0.\n       01 ws-R-store-03-tamount                pic 9(6)V99\n           value 0.\n       01 ws-R-store-07-tamount                pic 9(6)V99\n           value 0.\n\n      * SL output storage section\n       01 ws-SL-headline.\n           05  filler                          pic x(21)\n               value spaces.\n           05  filler                          pic x(20)\n               value \"Sale & Layway Report\".\n       \n       01 ws-S-columns.\n           05  filler                          pic x(18)\n               value \"Total Sale records\".\n           05  filler                          pic x(5)\n               value spaces.\n           05  filler                          pic x(17)\n               value \"Total Sale amount\".\n           05  filler                          pic x(4)\n               value spaces.\n           05  filler                          pic x(17)\n               value \"Sale Percentage: \".\n\n       01 ws-L-columns.\n           05  filler                          pic x(21)\n               value \"Total Layaway records\".\n           05  filler                          pic xx\n               value spaces.\n           05  filler                          pic x(19)\n               value \"Total Layway amount\".\n           05  filler                          pic xx\n               value spaces.\n           05  filler                          pic x(20)\n               value \"Layaway Percentage: \".\n\n       01 ws-S-output.\n           05  filler                          pic x(7)\n               value spaces.\n           05  ol-S-record                     pic zzz.\n           05  filler                          pic x(20)\n               value spaces.\n           05  ol-S-total                      pic $$$,$$9.99.\n           05  filler                          pic x(4)\n               value spaces.\n           05  ws-S-perc                       pic Z9.99.\n           05  filler                          pic x\n               value \"%\".\n\n       01 ws-L-output.\n           05  filler                          pic x(7)\n               value spaces.\n           05  ol-L-record                     pic zzz.\n           05  filler                          pic x(20)\n               value spaces.\n           05  ol-L-total                      pic $$$,$$9.99.\n           05  filler                          pic x(4)\n               value spaces.\n           05  ws-L-perc                       pic Z9.99.\n           05  filler                          pic x\n               value \"%\".\n\n       01 ws-SL-total.\n           05  filler                          pic x(30)\n               value \"Total Sale and Layway record: \".\n           05  ws-SL-combine-total             pic 999.\n           05  filler                          pic xxx\n               value spaces.\n           05  filler                          pic x(30)\n               value \"Total Sale and Layway amount: \".\n           05  ws-SL-tamount-final             pic $$$,$$9.99.\n\n       01 ws-SL-store-head.\n           05  filler                          pic x(24)\n               value \"Total Transaction Stores\".\n\n       01 ws-SL-store-01.\n           05  filler                          pic x(10)\n               value \"Store-01: \".\n           05  ol-SL-store-01                  pic $$$,$$9.99.\n\n       01 ws-SL-store-02.\n           05  filler                          pic x(10)\n               value \"Store-02: \".\n           05  ol-SL-store-02                  pic $$$,$$9.99.\n\n       01 ws-SL-store-03.\n           05  filler                          pic x(10)\n               value \"Store-03: \".\n           05  ol-SL-store-03                  pic $$$,$$9.99.\n\n       01 ws-SL-store-07.\n           05  filler                          pic x(10)\n               value \"Store-07: \".\n           05  ol-SL-store-07                  pic $$$,$$9.99.\n\n      * R output storage section\n       01 ws-R-headline.\n           05  filler                          pic x(21)\n               value spaces.\n           05  filler                          pic x(14)\n               value \"Returns Report\".\n\n       01 ws-R-output.\n           05  filler                          pic x(7)\n               value spaces.\n           05  ol-R-record                     pic zzz.\n           05  filler                          pic x(20)\n               value spaces.\n           05  ol-R-total                      pic $$$,$$9.99.\n\n       01 ws-R-columns.\n           05  filler                          pic x(21)\n               value \"Total returns records\".\n           05  filler                          pic x(5)\n               value spaces.\n           05  filler                          pic x(20)\n               value \"Total returns amount\".\n\n       01 ws-R-store-head.\n           05  filler                          pic x(19)\n               value \"Total Return Stores\".\n\n       01 ws-R-store-01.\n           05  filler                          pic x(10)\n               value \"Store-01: \".\n           05  ol-R-store-01                   pic $$$,$$9.99.\n\n       01 ws-R-store-02.\n           05  filler                          pic x(10)\n               value \"Store-02: \".\n           05  ol-R-store-02                   pic $$$,$$9.99.\n\n       01 ws-R-store-03.\n           05  filler                          pic x(10)\n               value \"Store-03: \".\n           05  ol-R-store-03                   pic $$$,$$9.99.\n\n       01 ws-R-store-07.\n           05  filler                          pic x(10)\n               value \"Store-07: \".\n           05  ol-R-store-07                   pic $$$,$$9.99.\n\n       01 ws-R-grand-total.\n           05  filler                          pic x(20)\n               value \"Grand Total Amount: \".\n           05  ws-R-calc-total                 pic $$$,$$9.99\n               value 0.\n       procedure division.\n           open input input-file,\n           output SL-RECORDS-DATA-FILE\n               RETURN-RECORDS-DATA-FILE COUNTS-RECORDS-FILE.\n\n           read input-file\n               at end move \"Y\"                 to ws-eof.\n           perform until ws-eof equals \"Y\"\n\n               perform 100-check-SL-or-R\n           \n           read input-file\n                   at end move \"Y\"             to ws-eof  \n           end-perform.\n\n           perform 210-calc-and-move-SL-totals.\n           perform 230-write-SL.\n\n           perform 220-calc-and-move-R-totals.\n           perform 240-wrote-R.\n          \n           close input-file SL-RECORDS-DATA-FILE\n                   RETURN-RECORDS-DATA-FILE COUNTS-RECORDS-FILE.\n\n           goback.\n\n       100-check-SL-or-R.\n           if (il-transaction-code = \"S\" OR \"L\") then\n               perform 110-SL-count-and-add\n               write SL-Line                    from input-line\n           else\n               perform 120-R-count-and-add\n               write R-line                     from input-line\n           end-if.\n\n       110-SL-count-and-add.\n           if (il-transaction-code = \"S\") then\n               add 1 to ws-sale-count\n               add il-transaction-amount       to ws-sale-tamount\n           end-if.\n\n           if (il-transaction-code = \"L\") then\n               add 1 to ws-layaway-count\n               add il-transaction-amount       to ws-layaway-tamount\n           end-if.\n\n           if (il-store-number = 01) then\n               add il-transaction-amount       to ws-SL-store-01-tamount\n           end-if.\n\n           if (il-store-number = 02) then\n               add il-transaction-amount       to ws-SL-store-02-tamount\n           end-if.\n\n           if (il-store-number = 03) then\n               add il-transaction-amount       to ws-SL-store-03-tamount\n           end-if.\n\n           if (il-store-number = 07) then\n               add il-transaction-amount       to ws-SL-store-07-tamount\n           end-if.\n       \n       120-R-count-and-add.\n           add 1 to ws-return-count\n           add il-transaction-amount           to ws-return-tamount\n\n           if (il-store-number = 01) then\n               add il-transaction-amount       to ws-R-store-01-tamount\n           end-if.\n\n           if (il-store-number = 02) then\n               add il-transaction-amount       to ws-R-store-02-tamount\n           end-if.\n\n           if (il-store-number = 03) then\n               add il-transaction-amount       to ws-R-store-03-tamount\n           end-if.\n\n           if (il-store-number = 07) then\n               add il-transaction-amount       to ws-R-store-07-tamount\n           end-if.\n\n       210-calc-and-move-SL-totals.\n           move ws-sale-count                  to ol-S-record.\n           move ws-sale-tamount                to ol-S-total.\n           move ws-layaway-count               to ol-L-record.\n           move ws-layaway-tamount             to ol-L-total.\n           move ws-SL-store-01-tamount         to ol-SL-store-01.\n           move ws-SL-store-02-tamount         to ol-SL-store-02.\n           move ws-SL-store-03-tamount         to ol-SL-store-03.\n           move ws-SL-store-07-tamount         to ol-SL-store-07.\n\n           compute ws-SL-combine-total =\n             (ws-sale-count + ws-layaway-count).\n\n           compute ws-SL-tamount =\n             (ws-sale-tamount + ws-layaway-tamount).\n\n           compute ws-S-perc rounded =\n             ((ws-sale-count / ws-SL-combine-total)*100).\n\n           compute ws-L-perc rounded =\n             ((ws-layaway-count / ws-SL-combine-total)*100).\n\n           move ws-SL-tamount                  to ws-SL-tamount-final.\n\n       220-calc-and-move-R-totals.\n           move ws-return-count                to ol-R-record.\n           move ws-return-tamount              to ol-R-total.\n           move ws-R-store-01-tamount          to ol-R-store-01.\n           move ws-R-store-02-tamount          to ol-R-store-02.\n           move ws-R-store-03-tamount          to ol-R-store-03.\n           move ws-R-store-07-tamount          to ol-R-store-07.\n\n           compute ws-R-calc-total = \n               (ws-SL-tamount - ws-return-tamount).\n\n       230-write-SL.\n           write C-line                       from ws-SL-headline.\n           write C-line                       from ws-newline.\n           write C-line                       from ws-S-columns.\n           write C-line                       from ws-S-output.\n           write C-line                       from ws-newline.\n           write C-line                       from ws-L-columns.\n           write C-line                       from ws-L-output.\n           write C-line                       from ws-newline.\n           write C-line                       from ws-SL-total.\n           write C-line                       from ws-newline.\n           write C-line                       from ws-SL-store-head.\n           write C-line                       from ws-SL-store-01.\n           write C-line                       from ws-SL-store-02.\n           write C-line                       from ws-SL-store-03.\n           write C-line                       from ws-SL-store-07.\n\n       240-wrote-R.\n           write C-line                        from ws-R-headline.\n           write C-line                        from ws-newline.\n           write C-line                        from ws-R-columns.\n           write C-line                        from ws-R-output.\n           write C-line                        from ws-newline.\n           write C-line                        from ws-R-store-head.\n           write C-line                        from ws-R-store-01.\n           write C-line                        from ws-R-store-02.\n           write C-line                        from ws-R-store-03.\n           write C-line                        from ws-R-store-07.\n           write C-line                        from ws-newline.\n           write C-line                        from ws-R-grand-total.\n\n       end program DataSplit."
  },
  "input_files": [
    {
      "file_name": "valid.out",
      "content": "S0125499CC01234567WIDGET-12345-AB\nL0089750CR02987654GADGET-98765-XY\nS0345600DB03456789TOOL-SET-456-ZZ\nR0067850CC02111222RETURN-ITM-789A\nS0198725DB07333444HARDWARE-BLT-90\nL0156300CR01555666FURNITURE-CHR-12\nS0087450CC03777888ELECTRONICS-TV5\nR0034200DB07999000DEFECT-PROD-456\nS0267890CR02121314APPLIANCE-REF-8\nL0123450DB01151617OUTDOOR-GRL-345"
    },
    {
      "file_name": "SL.out",
      "content": "S0125499CA02123456ELECTR-TOOL-5678\nL0089750DB03AB234567KITCHEN-APPL-901\nS0234500CC01XY345678GARDEN-HOSE-1234\nL0156780CA07MN456789FURNITURE-BED-567\nS0045620DB02PQ567890PAINT-BRUSH-8901\nS0198340CC03RS678901LIGHT-FIXTURE-23\nL0267890CA01TU789012CARPET-ROLL-4567\nS0312450DB07VW890123POWER-DRILL-6789\nL0089900CC02YZ901234WINDOW-BLIND-890\nS0156780CA03BC012345GARDEN-SHOVEL-12"
    },
    {
      "file_name": "returns.out",
      "content": "R0045000CA02AB123456ELEC-WIDGET-001\nR0032500CC03XY789012HDWR-GADGET-789\nR0018750DB07PQ345678APPL-DEVICE-456\nR0067800CA01MN901234FURN-CHAIR-2345\nR0025000CC02RS567890TOYS-PUZZLE-678\nR0041200DB03TU234567CLTH-SHIRT-9012\nR0015500CA07VW678901BOOK-NOVEL-3456\nR0089900CC01YZ012345ELEC-LAPTOP-567"
    },
    {
      "file_name": "counts.out",
      "content": "I need to analyze this carefully. The file \"counts.out\" is actually an OUTPUT file, not an input file. Looking at the COBOL code:\n\n```cobol\nselect COUNTS-RECORDS-FILE \n    assign to \"counts.out\"\n    organization is line sequential.\n```\n\nAnd in the procedure division:\n```cobol\nopen input input-file,\noutput SL-RECORDS-DATA-FILE\n    RETURN-RECORDS-DATA-FILE COUNTS-RECORDS-FILE.\n```\n\nThe COUNTS-RECORDS-FILE is opened as OUTPUT, meaning it's written TO, not read FROM. The program writes formatted report lines to this file.\n\nSince this is an output file that the program generates (not an input file it reads), no input test data should be generated for it."
    }
  ],
  "output_files": [],
  "input_output_files": [],
  "sysin_file": null
}