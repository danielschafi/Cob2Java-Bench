{
    "cobol_file": {
        "file_name": "successful_snippet_949a14a0.cob",
        "content": "       identification division.\n       program-id. Lab9CallCenterOperatorReport.\n       author. Henry Zheng.\n       date-written. 2018-04-25.\n      * Demonstrate the student's understanding of arrays and redefines\n\n       environment division.\n       input-output section.\n       file-control.\n\n           select input-file assign to 'lab9.data'\n               organization is line sequential.\n\n           select report-file assign to 'lab9.out'\n               organization is line sequential.\n\n       data division.\n       file section.\n\n       fd input-file \n           data record is emp-rec\n           record contains 35 characters.\n\n       01 emp-rec.\n           05 emp-rec-num               pic x(3).\n           05 emp-rec-name              pic x(12).\n           05 emp-rec-calls.\n               10 emp-rec-array         pic 999 occurs 6 times.\n\n       fd report-file \n           data record is print-line.\n\n       01 print-line                    pic x(132).\n\n       working-storage section.\n       \n      *create the necessary working storage variables for your code here\n       01 ws-constants.\n           05 ws-number-of-months       pic 99   value 6.\n           05 ws-zero                   pic x(4) value \"ZERO\".\n           05 ws-no-calls-total         pic 999  value 000.\n           05 ws-no-calls-month         pic 9    value 0.\n           05 ws-increment              pic 9    value 1.\n                                        \n       01 ws-array-iter                 pic 99   value 1.\n                                        \n       01 ws-count-month                pic 99   value 0.\n       01 ws-count-calls                pic 9(4) value 0.\n       01 ws-op-avg                     pic zz9  value 0.\n       01 ws-op-rem                     pic 9    value 0.\n       \n       01 ws-calculated-fields.\n           05 ws-non-zero-month-count   pic 9(2) value 0.\n           \n       \n       01 found-eof                     pic x value 'n'.\n           88 is-end-of-file                  value \"y\".\n\n       01 ws-totals.\n           05 ws-grand-total            pic 9(5) value 0.\n           05 ws-emp-total              pic 9(4) value 0.\n           05 ws-total-no-calls         pic 9(2) value 0.\n\n       01 name-line.\n           05 filler                    pic x(2) value spaces.\n           05 filler                    pic x(29)\n                                        value 'Henry Zheng, lab 9'.\n           05 filler                    pic x(5)  value spaces.\n           05 name-line-date            pic 9(6).\n           05 filler                    pic x(5)  value spaces.\n           05 name-line-time            pic 9(8).\n\n       01 report-heading.\n           05 filler                    pic x(20).\n           05 filler                    pic x(39)\n                        value 'call centre volumes for july - december'.\n\n       01 heading-line1.\n           05 filler                    pic x(2) value spaces.\n           05 filler                    pic x(8) value 'operator'.\n           05 filler                    pic x(2) value spaces.\n           05 filler                    pic x(8) value 'operator'.\n           05 filler                    pic x(6) value spaces.\n           05 filler                    pic x(3) value 'jul'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(3) value 'aug'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(3) value 'sep'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(3) value 'oct'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(3) value 'nov'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(3) value 'dec'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(5) value 'total'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(3) value 'avg'.\n           05 filler                    pic x(4) value spaces.\n           05 filler                    pic x(3) value 'rem'.\n\n       01 heading-line2.\n           05 filler                    pic x(5) value spaces.\n           05 filler                    pic x(1) value '#'.\n           05 filler                    pic x(8) value spaces.\n           05 filler                    pic x(4) value 'name'.\n\n       01 detail-line.\n           05 filler                    pic x(4) value spaces.\n           05 detail-line-num           pic x(3).\n           05 filler                    pic x(6) value spaces.\n           05 detail-line-name          pic x(12).\n           05 filler                    pic x(1) value spaces.\n           05 detail-line-months        pic x(7) occurs 6 times.   \n           05 filler                    pic x(1) value spaces.\n           05 detail-line-total         pic zz9.\n           05 filler                    pic x(4) value spaces.\n           05 detail-line-avg           pic zzz9.\n           05 detail-line-avg-text      redefines detail-line-avg\n                                        pic x(4).\n           05 filler                    pic x(4) value spaces.\n           05 detail-line-rem           pic 9.\n           05 detail-line-rem-text      redefines detail-line-rem\n                                        pic x.\n\n       01 monthly-total.\n           05 filler                    pic x(21)\n                            value \"Total number of calls\".\n       01 total-line1.\n           05 filler                    pic x(6) value spaces.\n           05 filler                    pic x(35)\n                            value \"number of operators with no calls: \".\n           05 total-line-no-calls       pic z9.\n\n       01 total-line2.\n           05 filler                    pic x(6) value spaces.\n           05 filler                    pic x(20)\n                                           value \"overall total calls:\".\n           05 filler                    pic x(15) value spaces.\n           05 total-line-calls          pic zzz99.\n\n       procedure division.\n           *> open file handles\n           open input input-file,\n                output report-file.\n\n           *> grab the current date & time\n           accept name-line-date from date.\n           accept name-line-time from time.\n\n           *> output heading\n           perform 000-print-headings.\n\n           *> process input file & output results\n           perform 100-read-input-file.\n           perform 200-process-records until is-end-of-file.\n\n           *> output total lines\n           perform 500-print-totals.\n\n           *> close file handles\n           close input-file\n                 report-file.\n                 \n           stop run.\n\n       000-print-headings.\n           write print-line from name-line before advancing 1 line.\n\n           write print-line from report-heading after advancing 1 line.\n\n           write print-line from heading-line1 after advancing 2 lines.\n           write print-line from heading-line2 after advancing 1 line.\n\n\n       100-read-input-file.\n           *> reads a line from input file & stores it in emp-rec\n           *> - unless eof is encountered in which case it sets found-eof to y\n           read input-file at end move 'y' to found-eof.\n\n       200-process-records.\n      **>  TODO: iterate through monthly calls table to find total\n      *          and how many months were non-zero. \n\n           perform \n               varying ws-array-iter\n               from 1 by 1\n               until ws-array-iter > ws-number-of-months\n\n               if (emp-rec-array(ws-array-iter) not = ws-no-calls-month)\n                   add 1 to ws-count-month\n               end-if\n\n               add emp-rec-array(ws-array-iter)\n                   to ws-emp-total\n\n               add emp-rec-array(ws-array-iter)\n                   to ws-count-calls\n               \n               add emp-rec-array(ws-array-iter)\n                   to ws-grand-total\n\n               move emp-rec-array(ws-array-iter)\n                   to detail-line-months(ws-array-iter)\n\n           end-perform.\n           \n           \n      **>  TODO: Implement average calculation logic as outlined in the\n      *          the requirments\n           \n           move emp-rec-num             to detail-line-num.\n           move emp-rec-name            to detail-line-name.\n           move ws-emp-total            to detail-line-total.\n\n           if (ws-emp-total equals ws-no-calls-total) then \n               move ws-zero             to detail-line-avg-text\n               move spaces              to detail-line-rem-text\n               add ws-increment         to ws-total-no-calls\n           else\n               divide ws-count-calls by ws-count-month\n                 giving ws-op-avg remainder ws-op-rem\n               move ws-op-avg           to detail-line-avg\n               move ws-op-rem           to detail-line-rem\n           end-if.\n\n           *> print detail line\n           write print-line from detail-line\n           after advancing 2 lines.\n\n           *> reset field for next record\n           perform 250-reset-field\n           *> read next record (if any)\n           perform 100-read-input-file.\n\n       250-reset-field.\n           move 0                       to ws-emp-total.\n           move 0                       to ws-non-zero-month-count.\n           move 0                       to ws-emp-total.\n           move 0                       to ws-count-calls.\n           move 0                       to ws-count-month.\n\n       500-print-totals.\n           move ws-total-no-calls       to total-line-no-calls.\n           move ws-grand-total          to total-line-calls.\n           \n           write print-line from total-line1\n               after advancing 2 lines.\n           write print-line from total-line2\n               after advancing 2 lines.\n\n       end program Lab9CallCenterOperatorReport."
    },
    "input_files": [
        {
            "file_name": "lab9.data",
            "content": "001Smith J     023045067089102034\n002Johnson M   012034056078090045\n003Williams K  000000000000000000\n004Brown T     045067089123145067\n005Davis R     034056078090102034\n006Miller P    023045067089102034\n007Wilson C    012034056078090045\n008Moore A     045067089123145067\n009Taylor S    034056078090102034\n010Anderson L  023045067089102034"
        },
        {
            "file_name": "lab9.out",
            "content": "001Smith, John 125098145078123065\n002Johnson, Mary234156187145167198\n003Williams, Bob078034056089045067\n004Brown, Susan189234201178156223\n005Davis, Carol000000000000000000\n006Miller, Tom  098123145167134178\n007Wilson, Lisa 156178189201167234\n008Moore, James 045067078089056098"
        }
    ],
    "output_files": [],
    "input_output_files": [],
    "sysin_file": null,
    "code_file": "successful_snippet_949a14a0.cob",
    "compiled_file": "successful_snippet_949a14a0",
    "expected_output": "",
    "expected_output_files": [],
    "expected_input_output_files": []
}