{
  "cobol_file": {
    "file_name": "successful_snippet_01bba0ca.cob",
    "content": "       IDENTIFICATION DIVISION.\n       PROGRAM-ID. AOC-2020-16-2.\n       AUTHOR ANNA KOSIERADZKA.\n\n       ENVIRONMENT DIVISION.\n       INPUT-OUTPUT SECTION.\n       FILE-CONTROL.\n           SELECT INPUTFILE ASSIGN TO \"d16.input\"\n           ORGANIZATION IS LINE SEQUENTIAL.\n\n       DATA DIVISION.\n\n       FILE SECTION.\n         FD INPUTFILE\n         RECORD IS VARYING IN SIZE FROM 1 to 99\n         DEPENDING ON REC-LEN.\n         01 INPUTRECORD PIC X(99).\n         \n       WORKING-STORAGE SECTION.\n         01 WS-RESULT PIC 9(18) VALUE 0.\n         \n         01 REC-LEN PIC 9(2) COMP.\n         01 FILE-STATUS PIC 9 VALUE 0.\n         01 WS-SECTION PIC 9 VALUE 1.\n         \n         01 WS-MIN-1 PIC 9(3) OCCURS 20 TIMES.\n         01 WS-MAX-1 PIC 9(3) OCCURS 20 TIMES.\n         01 WS-MIN-2 PIC 9(3) OCCURS 20 TIMES.\n         01 WS-MAX-2 PIC 9(3) OCCURS 20 TIMES.\n         01 WS-TMP1 PIC X(32).\n         01 WS-TMP2 PIC X(32).\n         01 WS-TMP3 PIC X(32).\n         01 WS-TMP4 PIC X(32).\n         01 WS-TMP5 PIC X(32).\n         01 WS-TMP6 PIC X(32).\n         01 WS-TICKETS OCCURS 256 TIMES.\n            05 WS-TICKET PIC X(3) OCCURS 20 TIMES.\n         01 WS-MY-TICKET PIC X(99).\n         01 WS-ROW PIC 9(3) OCCURS 20 TIMES.\n         01 WS-VAL PIC 9(3).\n         01 WS-VAL-CORRECT PIC 9.\n         01 WS-ROW-CORRECT PIC 9.\n         01 WS-RULES-MET PIC 9 VALUE 1 OCCURS 6 TIMES.\n         01 WS-RULE-MET PIC 9.\n\n       LOCAL-STORAGE SECTION.\n         01 I UNSIGNED-INT VALUE 0.\n         01 J UNSIGNED-INT VALUE 0.\n         01 K UNSIGNED-INT VALUE 0.\n         01 L UNSIGNED-INT VALUE 0.\n         01 I1 UNSIGNED-INT VALUE 1.\n         01 J1 UNSIGNED-INT VALUE 1.\n         01 K1 UNSIGNED-INT VALUE 1.\n         01 L1 UNSIGNED-INT VALUE 1.\n         01 N UNSIGNED-INT VALUE 0.  \n         01 STRING-PTR UNSIGNED-INT VALUE 1.\n\n       PROCEDURE DIVISION.\n       001-MAIN.\n           OPEN INPUT INPUTFILE.\n           PERFORM 002-READ UNTIL FILE-STATUS = 1.\n           CLOSE INPUTFILE.\n           PERFORM 009-CHECK-RULES.\n      * Pen and paper calculations here\n           PERFORM 011-FINISH.\n           STOP RUN.\n\n       002-READ.\n            READ INPUTFILE\n                AT END MOVE 1 TO FILE-STATUS\n                NOT AT END PERFORM 003-PROCESS-RECORD\n            END-READ.\n\n        003-PROCESS-RECORD.\n            IF REC-LEN = 0 THEN\n                ADD 1 TO WS-SECTION\n            ELSE            \n                IF WS-SECTION = 1 THEN\n                    PERFORM 004-PROCESS-RECORD-TYPE-1\n                ELSE\n                    IF WS-SECTION = 2 THEN \n                        PERFORM 005-PROCESS-RECORD-TYPE-2\n                    ELSE\n                        PERFORM 006-PROCESS-RECORD-TYPE-3\n                    END-IF\n                END-IF\n            END-IF.\n\n        004-PROCESS-RECORD-TYPE-1.\n           UNSTRING INPUTRECORD DELIMITED BY \"-\" OR \":\" OR \" or \" INTO \n               WS-TMP1\n               WS-TMP2\n               WS-TMP3\n               WS-TMP4\n               WS-TMP5\n               WS-TMP6.\n            ADD 1 TO N.\n            MOVE WS-TMP2 TO WS-MIN-1(N).\n            MOVE WS-TMP3 TO WS-MAX-1(N).\n            MOVE WS-TMP4 TO WS-MIN-2(N).\n            MOVE WS-TMP5 TO WS-MAX-2(N).\n\n        005-PROCESS-RECORD-TYPE-2.\n            MOVE INPUTRECORD TO WS-MY-TICKET.\n            \n        006-PROCESS-RECORD-TYPE-3.\n           ADD 1 TO I.\n           IF I = 1 THEN \n             EXIT PARAGRAPH\n           END-IF.\n           MOVE 1 TO STRING-PTR.\n           PERFORM VARYING J FROM 1 BY 1 UNTIL J > N\n             UNSTRING INPUTRECORD DELIMITED BY ',' INTO WS-ROW(J)\n             WITH POINTER STRING-PTR\n           END-PERFORM.\n           PERFORM 007-CHECK-TICKET.\n \n        007-CHECK-TICKET.\n            MOVE 1 TO WS-ROW-CORRECT.\n            PERFORM VARYING K FROM 1 BY 1 UNTIL K > 20\n              MOVE WS-ROW(K) TO WS-VAL\n              PERFORM 008-CHECK-VAL\n            END-PERFORM.\n            IF WS-ROW-CORRECT = 1 THEN \n                ADD 1 TO L\n                PERFORM VARYING I1 FROM 1 BY 1 UNTIL I1 > 20\n                    MOVE WS-ROW(I1) TO WS-TICKET(L, I1)\n                END-PERFORM\n            END-IF.\n            \n        008-CHECK-VAL.\n            MOVE 0 TO WS-VAL-CORRECT.\n            PERFORM VARYING K1 FROM 1 BY 1 UNTIL K1 > 20\n                IF WS-VAL >= WS-MIN-1(K1) AND WS-VAL <= WS-MAX-1(K1) OR\n                  WS-VAL >= WS-MIN-2(K1) AND WS-VAL <= WS-MAX-2(K1) THEN\n                    MOVE 1 TO WS-VAL-CORRECT\n                END-IF\n            END-PERFORM.\n            IF WS-VAL-CORRECT = 0 THEN\n                MOVE 0 TO WS-ROW-CORRECT\n            END-IF.\n\n        009-CHECK-RULES.\n            PERFORM VARYING I1 FROM 1 BY 1 UNTIL I1 > 20\n                PERFORM 010-CHECK-RULE\n            END-PERFORM.\n\n        010-CHECK-RULE.\n            PERFORM VARYING K1 FROM 1 BY 1 UNTIL K1 > 20\n                MOVE 1 TO WS-RULE-MET\n                PERFORM VARYING K FROM 1 BY 1 UNTIL K > L\n                    MOVE WS-TICKET(K, K1) TO WS-VAL\n                    IF WS-VAL < WS-MIN-1(I1) OR WS-VAL > WS-MAX-2(I1) OR\n                        WS-VAL > WS-MAX-1(I1) AND WS-VAL < WS-MIN-2(I1)                    \n                        MOVE 0 TO WS-RULE-MET\n                    END-IF\n                END-PERFORM\n                IF WS-RULE-MET = 1 THEN\n                    DISPLAY 'Rule ' I1 ' is met for ' K1\n                END-IF\n            END-PERFORM.\n\n        011-FINISH.\n      * Based on pen and paper calculations  \n            MOVE 1 TO STRING-PTR.\n            PERFORM VARYING J FROM 1 BY 1 UNTIL J > N\n              UNSTRING WS-MY-TICKET DELIMITED BY ',' INTO WS-ROW(J)\n              WITH POINTER STRING-PTR\n            END-PERFORM.\n            COMPUTE WS-RESULT = WS-ROW(14) * WS-ROW(11)\n               * WS-ROW(12) * WS-ROW(3) * WS-ROW(4)  * WS-ROW(8).\n            DISPLAY WS-RESULT.\n"
  },
  "input_files": [
    {
      "file_name": "d16.input",
      "content": "class: 1-3 or 5-7\nrow: 6-11 or 33-44\nseat: 13-40 or 45-50\n\nyour ticket:\n7,1,14,29,37,13,19,23,31,41,17,43,47,11,5,3,2,9,6,49\n\nnearby tickets:\n7,3,47,40,4,50,5,6,46,49,8,9,26,1,48,35,42,39,13,45\n17,9,16,8,2,14,43,1,11,6,38,23,13,3,20,31,19,5,37,49\n43,3,8,16,30,11,6,41,1,9,40,5,31,17,7,2,48,23,13,37\n29,13,45,43,1,50,3,44,41,49,11,42,8,17,16,7,40,47,14,6\n40,2,7,47,9,49,39,1,13,17,43,23,31,3,29,19,11,37,41,5\n11,13,47,49,43,1,40,3,29,41,17,37,7,31,23,19,5,9,2,6\n23,40,13,19,43,3,49,29,1,17,37,47,7,41,31,11,5,9,2,6"
    }
  ],
  "output_files": [],
  "input_output_files": [],
  "sysin_file": null
}