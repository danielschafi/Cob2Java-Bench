{
  "cobol_file": {
    "file_name": "successful_snippet_bcc66a30.cob",
    "content": "       IDENTIFICATION DIVISION.\n       PROGRAM-ID. AOC-2020-08-2.\n       AUTHOR ANNA KOSIERADZKA.\n      \n       ENVIRONMENT DIVISION.\n       INPUT-OUTPUT SECTION.\n       FILE-CONTROL.\n           SELECT INPUTFILE ASSIGN TO \"d08.input\"\n           ORGANIZATION IS LINE SEQUENTIAL.\n           \n       DATA DIVISION.\n       FILE SECTION.\n         FD INPUTFILE.\n         01 INPUTRECORD. \n           05 INPUT-INSTRUCTION PIC X(3).\n           05 INPUT-SPACE PIC X.\n           05 INPUT-SIGN PIC X(1).\n           05 INPUT-ARG PIC 9(3).\n         \n       WORKING-STORAGE SECTION.\n         01 FILE-STATUS PIC 9 VALUE 0.\n         01 N PIC 9(3) VALUE 625.\n         01 WS-CODE OCCURS 0 TO 999 TIMES DEPENDING ON N.\n           05 WS-INSTRUCTION PIC X(3).\n           05 WS-SIGN PIC X.\n           05 WS-ARG PIC 9(3).\n           05 WS-DONE PIC 9 VALUE 0.\n         01 WS-I PIC X(3).\n         01 WS-ACC PIC S9(6) VALUE 0.\n         01 ARG PIC 9(3) VALUE 0.\n\n       LOCAL-STORAGE SECTION.\n         01 I UNSIGNED-INT VALUE 1.         \n         01 CODE-POS UNSIGNED-INT VALUE 1.\n         01 PREV-CHANGED UNSIGNED-INT VALUE 0.\n         01 CURR-CHANGED UNSIGNED-INT VALUE 0.\n\n       PROCEDURE DIVISION.\n       001-MAIN.\n           OPEN INPUT INPUTFILE.\n           PERFORM 002-READ UNTIL FILE-STATUS = 1.\n           CLOSE INPUTFILE.\n           PERFORM 000-SWITCH-NEXT UNTIL 1 = 0.\n           STOP RUN.\n\n       002-READ.\n            READ INPUTFILE\n                AT END MOVE 1 TO FILE-STATUS\n                NOT AT END PERFORM 003-PROCESS-RECORD\n            END-READ.\n       \n       003-PROCESS-RECORD.\n           MOVE INPUT-INSTRUCTION TO WS-INSTRUCTION(I).\n           MOVE INPUT-SIGN TO WS-SIGN(I).\n           MOVE INPUT-ARG TO WS-ARG(I).\n           ADD 1 TO I.\n\n       000-SWITCH-NEXT.\n           PERFORM WITH TEST AFTER\n             UNTIL WS-INSTRUCTION(CURR-CHANGED) = \"nop\" \n             OR WS-INSTRUCTION(CURR-CHANGED) = \"jmp\"              \n               ADD 1 TO CURR-CHANGED\n           END-PERFORM.\n           IF WS-INSTRUCTION(CURR-CHANGED) = \"nop\" THEN\n               MOVE \"jmp\" TO WS-INSTRUCTION(CURR-CHANGED)\n           ELSE \n               MOVE \"nop\" TO WS-INSTRUCTION(CURR-CHANGED)\n           END-IF.    \n           IF PREV-CHANGED > 0 THEN\n               IF WS-INSTRUCTION(PREV-CHANGED) = \"nop\" THEN\n                   MOVE \"jmp\" TO WS-INSTRUCTION(PREV-CHANGED)\n               ELSE \n                   MOVE \"nop\" TO WS-INSTRUCTION(PREV-CHANGED)\n               END-IF\n           END-IF.\n           MOVE CURR-CHANGED TO PREV-CHANGED.\n           PERFORM 004-RUN-CODE.\n\n       004-RUN-CODE.\n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > N\n               MOVE 0 TO WS-DONE(I)\n           END-PERFORM.\n           MOVE 0 TO WS-ACC.\n           MOVE 1 TO CODE-POS.\n           PERFORM 005-RUN-INSTRUCTION UNTIL WS-DONE(CODE-POS) = 2.\n\n       005-RUN-INSTRUCTION.\n           IF CODE-POS = N + 1 THEN\n               DISPLAY WS-ACC\n               STOP RUN\n           END-IF.\n\n           ADD 1 TO WS-DONE(CODE-POS).\n           MOVE WS-INSTRUCTION(CODE-POS) TO WS-I.\n           COMPUTE ARG = FUNCTION NUMVAL(WS-ARG(CODE-POS)).\n\n           IF WS-I = \"nop\" THEN \n              ADD 1 TO CODE-POS\n           END-IF.\n                      \n           IF WS-I = \"acc\" THEN \n              IF WS-SIGN(CODE-POS) = \"+\" THEN\n                COMPUTE WS-ACC = WS-ACC + ARG\n              ELSE \n                COMPUTE WS-ACC = WS-ACC - ARG\n              END-IF\n              ADD 1 TO CODE-POS\n           END-IF.\n\n           IF WS-I = \"jmp\" THEN \n              IF WS-SIGN(CODE-POS) = \"+\" THEN\n                COMPUTE CODE-POS = CODE-POS + ARG\n              ELSE \n                COMPUTE CODE-POS = CODE-POS - ARG\n              END-IF\n           END-IF.\n"
  },
  "input_files": [
    {
      "file_name": "d08.input",
      "content": "nop +000\nacc +001\njmp +004\nacc +003\njmp -003\nacc -099\nacc +001\njmp +002\nacc +006\nnop +142"
    }
  ],
  "output_files": [],
  "input_output_files": [],
  "sysin_file": null
}