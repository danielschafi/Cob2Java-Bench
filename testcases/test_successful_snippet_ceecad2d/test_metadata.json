{
  "cobol_file": {
    "file_name": "successful_snippet_ceecad2d.cob",
    "content": "       IDENTIFICATION DIVISION.\n      *=======================*\n       PROGRAM-ID.   CGPRG006.\n       AUTHOR.       ANA CAROLINA GOMES DA SILVA.\n       DATE-WRITTEN. 03/09/2019.\n       DATE-COMPILED. 11/04/2021.\n      *--------------------------------------------------------------*\n      * DISCIPLINA PROGRAMACAO MAINFRAME\n      *--------------------------------------------------------------*\n      * OBJETIVO: RECEBER DADOS DA SYSIN(ACCEPT)\n      *           CALCULAR A MEDIA ARITMETICA BIMESTRAL\n      *--------------------------------------------------------------*\n      *------------------> HISTORICO - MANUTENCAO <------------------*\n      * VERSAO  MES/ANO  NR.DOC  IDENT.  DESCRICAO\n      * ------  -------  ------  ------  -------------------------   *\n      *  V01    FEV/2013 010001  SISTEMA MOSTRA SYSOUT\n      *--------------------------------------------------------------*\n       ENVIRONMENT DIVISION.\n      *====================*\n       CONFIGURATION SECTION.\n      *---------------------*\n       SPECIAL-NAMES.\n           DECIMAL-POINT IS COMMA\n           CURRENCY SIGN IS \"R$ \" WITH PICTURE SYMBOL \"$\"\n           .\n       INPUT-OUTPUT SECTION.\n      *---------------------*\n       DATA DIVISION.\n      *=============*\n       FILE SECTION.\n      *------------*\n       WORKING-STORAGE SECTION.\n      *-----------------------*\n       01  FILLER                 PIC X(35)        VALUE\n           '**** INICIO DA WORKING-STORAGE ****'.\n\n      *-----> VARIAVEIS AUXILIARES UTILIZADA NO PROCESSAMENTO\n       01  WS-AREA-AUX.\n           05  WS-FIM                 PIC X(01).\n           05  WS-CTLIDO              PIC 9(02).\n           05  MEDIA-SP               PIC 9(04).\n           05  TOTAL-SP               PIC 9(04).\n           05  QTD-CID-SP             PIC 9(04).\n           05  PCT-ACID               PIC 9(04).\n           05  CID-MAIOR              PIC 9(04).\n           05  ACID-MAIOR-TOTAL       PIC 9(04).\n           05  QTD-CID-MAIOR          PIC 9(04).\n           05  CID-MENOR              PIC 9(04).\n           05  PCT-MENOR              PIC 9(04).\n           05  CID-MENOR-VEICS        PIC 9(04).\n           05  CID-MENOR-OBITOS       PIC 9(04).\n      *-----> ENTRADA - DADOS VIA SYSIN (NO JCL DE EXECUCAO)\n       01  WS-REG-SYSIN.\n           05 WS-CIDADE           PIC 9(05).\n           05 WS-ESTADO           PIC X(02).\n           05 WS-QTD-VEICULOS     PIC 9(07).\n           05 WS-BAFOMETRO        PIC X(01).\n           05 WS-QTD-ACIDENTES    PIC 9(04).\n           05 WS-QTD-OBITOS       PIC 9(04).\n\n       01  WS-REG-SYSOUT.\n           05 CID                 PIC 99999.\n           05 FILLER              PIC X(02)         VALUE SPACES.\n           05 UF                  PIC XX.\n           05 FILLER              PIC X(04)        VALUE SPACES.\n           05 VEICS               PIC Z.ZZZ.ZZ9.\n           05 FILLER              PIC X(04)        VALUE SPACES.\n           05 BAFO                PIC X.\n           05 FILLER              PIC X(04)        VALUE SPACES.\n           05 ACIDS               PIC Z.ZZ9.\n           05 FILLER              PIC X(04)        VALUE SPACES.\n           05 OBITOS              PIC Z.ZZ9.\n           05 FILLER              PIC X(04)        VALUE SPACES.\n           05 PORC-ACIDS          PIC ZZ9,99.\n\n       01  FILLER                 PIC X(35)        VALUE\n\n\n           '****** FIM DA WORKING-STORAGE *****'.\n      *\n       PROCEDURE DIVISION.\n      *==================*\n      *--------------------------------------------------------------*\n      *    PROCESSO PRINCIPAL\n      *--------------------------------------------------------------*\n       000-CGPRG006.\n\n           PERFORM 010-INICIAR\n           PERFORM 030-PROCESSAR UNTIL WS-FIM = 'S'\n           PERFORM 040-PROCESSAR-SP\n           PERFORM 045-PROCESSAR-MAIOR\n           PERFORM 047-PROCESSAR-MENOR\n           PERFORM 090-TERMINAR\n           STOP RUN\n           .\n      *--------------------------------------------------------------*\n      *    PROCEDIMENTOS INICIAIS\n      *--------------------------------------------------------------*\n       010-INICIAR.\n\n           DISPLAY \"ANA CAROLINA GOMES DA SILVA\"\n           DISPLAY \"ATIVIDADE 6\"\n           DISPLAY \"ESTATISTICAS - DATA DO CALCULO: 11/04/2021\"\n\n           PERFORM 025-LER-SYSIN\n           .\n      *--------------------------------------------------------------*\n      *    LEITURA DADOS DA SYSIN\n      *--------------------------------------------------------------*\n       025-LER-SYSIN.\n\n           ACCEPT WS-REG-SYSIN  FROM SYSIN\n\n           IF WS-REG-SYSIN = ALL '9'\n              MOVE   'S'     TO  WS-FIM\n           ELSE\n              ADD 1  TO WS-CTLIDO\n           END-IF\n           .\n      *--------------------------------------------------------------*\n      *    PROCESSAR DADOS RECEBIDOS DA SYSIN ATE FIM DOS REGISTROS\n      *--------------------------------------------------------------*\n       030-PROCESSAR.\n\n           COMPUTE PCT-ACID = WS-QTD-ACIDENTES*WS-QTD-OBITOS/100.\n           MOVE WS-ESTADO       TO UF.\n           MOVE WS-QTD-VEICULOS TO VEICS.\n           MOVE WS-BAFOMETRO    TO BAFO.\n           MOVE WS-QTD-OBITOS   TO ACIDS.\n           MOVE WS-QTD-OBITOS   TO OBITOS.\n           MOVE PCT-ACID        TO PORC-ACIDS.\n\n           PERFORM 025-LER-SYSIN\n           .\n      *--------------------------------------------------------------*\n      *    DADOS DE SAO PAULO\n      *--------------------------------------------------------------*\n       040-PROCESSAR-SP.\n\n           IF WS-CIDADE = \"SAO PAULO\" THEN\n               ADD 1 TO QTD-CID-SP\n\n           END-IF\n\n           COMPUTE TOTAL-SP = QTD-CID-SP*WS-QTD-ACIDENTES.\n           COMPUTE MEDIA-SP = TOTAL-SP/PCT-ACID.\n\n           DISPLAY \"------------------------\"\n           DISPLAY \"Media de porcentagens de SP..............:\"MEDIA-SP.\n           DISPLAY \"Qtde. de acidentes totais em SP.........:\"TOTAL-SP.\n           DISPLAY \"Qtde. de cidades de SP pesquisadas......:\"QTD-CID-SP.\n           .\n      *--------------------------------------------------------------*\n      *    PROCESSAR DADOS MAIORES QUANTIDADES DE ACIDENTES\n      *--------------------------------------------------------------*\n       045-PROCESSAR-MAIOR.\n\n           IF WS-QTD-ACIDENTES > 15000 OR WS-QTD-OBITOS > 5000 THEN\n               ADD 1 TO CID-MAIOR\n               MOVE WS-CIDADE TO CID\n           END-IF\n\n           COMPUTE ACID-MAIOR-TOTAL = CID-MAIOR/WS-QTD-ACIDENTES.\n           COMPUTE QTD-CID-MAIOR = WS-QTD-ACIDENTES*CID-MAIOR.\n\n           DISPLAY \"------------------------\"\n           DISPLAY \"Cidade com MAIOR quantidade de acidentes:\" CID.\n           DISPLAY \"Qtde. de acidentes desta cidade..:\" ACID-MAIOR-TOTAL.\n           DISPLAY \"Qtde. TOTAL de cidades pesquisadas..:\" QTD-CID-MAIOR.\n           .\n\n      *--------------------------------------------------------------*\n      *    PROCESSAR DADOS MENORES QUANTIDADES DE ACIDENTES\n      *--------------------------------------------------------------*\n       047-PROCESSAR-MENOR.\n\n           IF WS-QTD-ACIDENTES < 5000 OR WS-QTD-OBITOS < 500 THEN\n               ADD 1 TO CID-MENOR\n               MOVE WS-CIDADE TO CID\n               MOVE WS-QTD-VEICULOS TO CID-MENOR-VEICS\n               MOVE WS-QTD-OBITOS TO CID-MENOR-OBITOS\n           END-IF\n\n           COMPUTE PCT-MENOR = CID-MENOR-VEICS*CID-MENOR-OBITOS/100.\n\n           DISPLAY \"------------------------\"\n           DISPLAY \"Cidade com MENOR porcentagem de obitos..:\"CID.\n           DISPLAY \"Porcentagem obitos/acidente desta cidade:\" PCT-MENOR.\n           .\n      *--------------------------------------------------------------*\n      *    PROCEDIMENTOS FINAIS\n      *--------------------------------------------------------------*\n       090-TERMINAR.\n\n           DISPLAY ' *========================================*'\n           DISPLAY ' *   TOTAIS DE CONTROLE - CGPRG006        *'\n           DISPLAY ' *----------------------------------------*'\n           DISPLAY ' * REGISTROS LIDOS    - SYSIN  = ' WS-CTLIDO\n           DISPLAY ' *========================================*'\n           DISPLAY ' *----------------------------------------*'\n           DISPLAY ' *      TERMINO NORMAL DO CGPRG006        *'\n           DISPLAY ' *----------------------------------------*'\n           .\n      *---------------> FIM DO PROGRAMA CGPRG006 <-------------------*\n"
  },
  "input_files": [],
  "output_files": [],
  "input_output_files": [],
  "sysin_file": {
    "file_name": "sysin.txt",
    "content": "00001SP00123456S012500350\n00002RJ00098765N008900280\n00003MG00156789S018000620\n00004SP00087654N004500180\n00005BA00234567S022000750\n00006RS00045678N003200120\n00007SP00198765S016500580\n99999999999999999999999"
  }
}