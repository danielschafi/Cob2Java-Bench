{
  "cobol_file": {
    "file_name": "successful_snippet_c486f1c6.cob",
    "content": "       IDENTIFICATION DIVISION.\n      *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-\n       PROGRAM-ID. REPORTE-COMPARATIVO.\n       AUTHOR.\n           PROG.ADRIANACORTES\n       DATE-WRITTEN.\n           01/JULY/2015\n       ENVIRONMENT DIVISION.\n\n       CONFIGURATION SECTION.\n       SOURCE-COMPUTER.\n           IBM-370.\n       OBJECT-COMPUTER.\n           IBM-370.\n\n       INPUT-OUTPUT SECTION.\n       FILE-CONTROL.\n      *-----------------------\n      *-----------------------\n      *Entrada\n      *----\n           SELECT ARCH-AC-ARCHIVO-CONSUMO ASSIGN W000-UT-S-DIR-CONSUMO\n                                           ORGANIZATION IS LINE\n                                           SEQUENTIAL.\n\n           SELECT ARCH-AD-ARCHIVO-DEVOLUCION ASSIGN\n                                           W000-UT-S-DIR-DEVOLUCION\n                                           ORGANIZATION IS LINE\n                                           SEQUENTIAL.\n\n           SELECT ARCH-AT-ARCHIVO-TABLA ASSIGN W000-UT-S-DIR-TABLA\n                                           ORGANIZATION IS LINE\n                                           SEQUENTIAL.\n\n           SELECT ARCH-AP-ARCHIVO-PRODUCTO ASSIGN W000-UT-S-DIR-PRODUCTO\n                                           ORGANIZATION IS LINE\n                                           SEQUENTIAL.\n           SELECT ARCH-AF-ARCHIVO-FECHA    ASSIGN W000-UT-S-DIR-FECHA\n                                           ORGANIZATION IS LINE\n                                           SEQUENTIAL.\n      *----\n      *Salida\n      *----\n           SELECT REPO-R1-REPORTE ASSIGN TO\n           W000-UT-S-DIR-SALIDA-REPO.\n      *-----------------------\n       DATA DIVISION.\n      *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-\n       FILE SECTION.\n       FD  ARCH-AC-ARCHIVO-CONSUMO\n           LABEL RECORD STANDARD.\n       01 AI-ARCHIVO-CONSUMO.\n           05 RI-C-CVE                   PIC XX.\n           05 RI-C-PTA                   PIC XXX.\n           05 RI-C-DPTO                  PIC X(6).\n           05 RI-C-CODIGO                PIC X(6).\n           05 RI-C-CANT-CONSUMO          PIC 9(8).\n\n       FD  ARCH-AD-ARCHIVO-DEVOLUCION\n           LABEL RECORD STANDARD.\n       01 AI-ARCHIVO-DEVOLUCION.\n           05 RI-D-PTA                   PIC XXX.\n           05 RI-D-DPTO                  PIC X(6).\n           05 RI-D-CODIGO                PIC X(6).\n           05 RI-D-CANT-DEVUELTA         PIC 9(8).\n\n       FD  ARCH-AT-ARCHIVO-TABLA\n           LABEL RECORD STANDARD.\n       01 AI-ARCHIVO-TABLA.\n           05 RI-T-CVE                   PIC XXX.\n           05 RI-T-PTA                   PIC XXX.\n           05 RI-T-DPTO                  PIC X(6).\n           05 RI-T-ESPACIOS              PIC X(11).\n           05 RI-T-DESCRIPCION           PIC X(30).\n\n       FD  ARCH-AP-ARCHIVO-PRODUCTO\n           LABEL RECORD STANDARD.\n       01 AI-ARCHIVO-PRODUCTO.\n           05 RI-P-CODIGO                PIC X(6).\n           05 RI-P-DESCRIPCION           PIC X(30).\n           05 RI-P-CTO                   PIC 9(3).\n\n       FD  ARCH-AF-ARCHIVO-FECHA\n           LABEL RECORD STANDARD.\n       01 AI-ARCHIVO-FECHA.\n          05 RI-F-CVE-TARJ               PIC XXX.\n          05 RI-F-ACCESO                 PIC XXX.\n          05 RI-F-COMP-YEAR              PIC 99.\n          05 RI-F-YEAR                   PIC 99.\n          05 RI-F-MONTH                  PIC 99.\n          05 RI-F-DAY                    PIC 99.\n\n       FD  REPO-R1-REPORTE\n           RECORD CONTAINS 120 CHARACTERS\n           LABEL RECORD STANDARD.\n       01  R1-COMPARACION                PIC X(120).\n\n       WORKING-STORAGE SECTION.\n      *---\n      *Switches\n      *---\n       01  S000-ESTADOS.\n           05  S000-ESTADOARCHCONSUMO    PIC X.\n           05  S000-FINARCHCONSUMO       PIC X.\n           05  S000-ESTADOARCHDEVOLUCION PIC X.\n           05  S000-FINARCHDEVOLUCION    PIC X.\n           05  S000-ESTADOARCHTABLA      PIC X  VALUE '0'.\n           05  S000-FINARCHTABLA         PIC X.\n           05  S000-ESTADOARCHPRODUCTO   PIC X  VALUE '0'.\n           05  S000-FINARCHPRODUCTO      PIC X.\n           05  S000-FINARCHFECHA         PIC X.\n           05  S000-ESTADOARCHFECHA      PIC X.\n           05  S000-ESTADOREPO           PIC X.\n\n\n      *---\n      *Constantes\n      *---\n       01  W000-CTES.\n           05  W000-PROG                 PIC X(8)\n                                         VALUE 'P-COS720'.\n           05  W000-UT-S-DIR-CONSUMO     PIC X(20)\n                                         VALUE 'ArchivoConsumo.dat'.\n           05  W000-UT-S-DIR-DEVOLUCION  PIC X(25)\n                                         VALUE 'ArchivoDevolucion.dat'.\n           05  W000-UT-S-DIR-TABLA       PIC X(20)\n                                         VALUE 'ArchivoTabla.dat'.\n           05  W000-UT-S-DIR-PRODUCTO     PIC X(20)\n                                         VALUE 'ArchivoProducto.dat'.\n           05  W000-UT-S-DIR-FECHA        PIC X(10)\n                                         VALUE 'Fecha.dat'.\n           05  W000-UT-S-DIR-SALIDA-REPO PIC X(30)\n                                         VALUE 'ReporteComparacion.txt'.\n      *---\n      *   Fecha\n      *---\n       01 W000-FECHA.\n           05 W000-FIRST-TWO-DIGIT-YEAR   PIC 99.\n           05 W000-YEAR                   PIC 99.\n           05 W000-MONTH                  PIC 99.\n           05 W000-DAY                    PIC 99.\n      *---\n      *Costo por unidad\n      *---\n       01 W050-COSTO                      PIC 999.\n      *---\n      *   Identidades\n      *---\n       01 I040-ID-PROC-CONSUMO.\n           05 I040-ID-PROC-CODIGO-CONS.\n               10 I040-ID-PROC-DPTO-CONS.\n                   15 I040-ID-PROC-PTA-CONS.\n                    20 I040-PTA           PIC XXX.\n                   15 I040-DPTO           PIC X(6).\n               10 I040-CODIGO             PIC X(6).\n\n       01 I070-AC-ID-ANT                  PIC X(15).\n       01 I070-AC-ID-LEI-CONSUMO.\n           05 I070-AC-ID-CODIGO-CONS.\n               10 I070-AC-ID-DPTO-CONS.\n                   15 I070-AC-ID-PTA-CONS.\n                    20 I070-PTA           PIC XXX.\n                   15 I070-DPTO           PIC X(6).\n               10 I070-CODIGO             PIC X(6).\n\n       01 I080-AT-ID-ANT                  PIC X(12).\n       01 I080-AT-ID-LEI-TABLA.\n           05 I080-AT-ID-LLAVE.\n               10 I080-CLAVE              PIC XXX.\n               10 I080-AT-ID-DPTO.\n                 15 I080-PTA              PIC XXX.\n                 15 I080-DPTO             PIC X(6).\n\n       01 I100-AP-ID-ANT                  PIC X(6).\n       01 I100-AP-ID-LEI-PRODUCTO.\n           05 I100-AP-ID-CODIGO.\n               10 I100-CODIGO             PIC X(6).\n\n       01 I110-AD-ID-ANT                  PIC X(15).\n       01 I110-AD-ID-LEI-DEVOLUCION.\n           05 I110-AD-ID-CODIGO-DEV.\n               10 I110-AD-ID-DPTO-DEV.\n                   15 I110-AD-ID-PTA-DEV.\n                    20 I110-PTA           PIC XXX.\n                   15 I110-DPTO           PIC X(6).\n               10 I110-CODIGO             PIC X(6).\n\n      *---\n      *   Acumuladores\n      *---\n       01  A050-ACUMULADOR-RA.\n           05  A050-ACUM-A-FAVOR-RA       PIC S9(8)V99.\n           05  A050-ACUM-TOTAL-IMPORTE-RA PIC S9(8)V99.\n\n       01  A060-ACUMULADOR-RA-REG.\n           05  A060-ACUM-REG-RA-IMPORTE   PIC S9(8)V99.\n           05  A060-ACUM-REG-RA-CONSUMO   PIC S9(8).\n\n       01  A050-ACUMULADOR-RP.\n           05  A050-ACUM-A-FAVOR-RP       PIC S9(8)V99.\n           05  A050-ACUM-TOTAL-IMPORTE-RP PIC S9(8)V99.\n\n       01  A060-ACUMULADOR-RP-REG.\n           05  A060-ACUM-REG-RP-IMPORTE   PIC S9(8)V99.\n           05  A060-ACUM-REG-RP-CONSUMO   PIC S9(8).\n\n       01  A060-ACUMULADOR-DIFERENCIA.\n           05  A060-ACUM-DIF-IMPORTE      PIC 9(8)V99.\n           05  A060-ACUM-DIF-CONSUMO      PIC 9(8).\n\n       01  A060-ACUMULADOR-DEVUELTO.\n           05 A060-ACUM-DEV               PIC S9(8).\n      *---\n      *Cifras control\n      *---\n       01 A990-CIFRAS-CONTROL.\n           05 A990-PROC-LEIDO-CONSUMO     PIC S9(4).\n           05 A990-PROC-LEIDO-DEVOLUCION  PIC S9(4).\n           05 A990-PROC-LEIDO-TABLA       PIC S9(4).\n           05 A990-PROC-LEIDO-PRODUCTO    PIC S9(4).\n           05 A990-PROC-PTA               PIC S9(4).\n           05 A990-PROC-DPTO              PIC S9(4).\n           05 A990-PROC-REG               PIC S9(4).\n           05 A990-PROC-A-FAVOR-RA        PIC S9(4).\n           05 A990-PROC-A-FAVOR-RP        PIC S9(4).\n           05 A990-PROC-EMPATE            PIC S9(4).\n      *---\n      * Tabla\n      *---\n       01  T010-MONTHS-TABLE              PIC X(36)      VALUE\n       'ENEFEBMARABRMAYJUNJULAGOSEPOCTNOVDIC'.\n       01  T010-MONTH-TABLE          REDEFINES T010-MONTHS-TABLE.\n           05  T010-MONTH             OCCURS 12\n                                          PIC XXX.\n       01  T010-VARS.\n           05  T010-I                     PIC 99.\n           05  T010-NUM-ELEM              PIC S9(9)      COMP.\n           05  T010-MAX-ELEM              PIC S9(9)      COMP.\n       01 T020-TABLA-ARCH-T04.\n           05 T020-DETALLES-T04      OCCURS 30 TIMES INDEXED\n           BY T020-I-T04-I.\n               10 T020-PTA-T04            PIC XXX.\n               10 T020-DESCRIPCION-T04    PIC X(30).\n       01  T020-VARS-T04.\n           05  T020-I-T04                 PIC 99.\n           05  T020-NUM-ELEM-T04          PIC S9(2).\n           05  T020-MAX-ELEM-T04          PIC S9(2) VALUE 30.\n\n       01 T020-TABLA-ARCH-T05.\n           05 T020-DETALLES-T05      OCCURS 30 TIMES INDEXED\n           BY T020-I-T05-I.\n               10 T020-CLAVE.\n                   15 T020-PTA-T05        PIC XXX.\n                   15 T020-DPTO-T05       PIC X(9).\n               10 T020-DESCRIPCION-T05    PIC X(30).\n       01  T020-VARS-T05.\n           05  T020-I-T05                 PIC 99.\n           05  T020-NUM-ELEM-T05          PIC S9(2).\n           05  T020-MAX-ELEM-T05          PIC S9(2) VALUE 30.\n       01 T030-TABLA-PRODUCTOS.\n           05 T030-DETALLES-PRODUCTOS OCCURS 30 TIMES INDEXED\n           BY T030-I-PRODUCTO.\n               10 T030-CODIGO             PIC X(6).\n               10 T030-DESCRIPCION        PIC X(30).\n               10 T030-CTO                PIC 9(3).\n       01  T030-VARS-PRODUCTO.\n           05  T030-I-PR                  PIC 99.\n           05  T030-NUM-ELEM-PR           PIC S9(2).\n           05  T030-MAX-ELEM-PR           PIC S9(2) VALUE 30.\n      *---\n      *Variables del reporte\n      *---\n       01 R1-VARS.\n           05 R1-NUM-HOJA                 PIC S9(9).\n           05 R1-NUM-LIN                  PIC S9(9).\n           05 R1-MAX-LIN                  PIC S9(9)       VALUE 200.\n      *---\n      *Lineas de titulo\n      *---\n       01 R1-05-ENCABEZADOS-PRIMERA-LINEA.\n           05 FILLER                      PIC X           VALUE SPACES.\n           05 R1-05-CONSPRO               PIC X(8).\n           05 FILLER                      PIC X(2)       VALUE SPACES.\n           05 FILLER                      PIC X(60)       VALUE\n          \"R E P O R T E C O M P A R A T I V O   D E   C O N S U M O S\".\n           05 FILLER                      PIC X(3)       VALUE SPACES..\n           05 FILLER                      PIC X(7)        VALUE\n           \"FECHA: \".\n           05 R1-05-FECHA.\n               10 R1-05-DAY               PIC X(2).\n               10 FILLER                  PIC X           VALUE SPACES.\n               10 R1-05-MONTH             PIC X(3).\n               10 FILLER                  PIC X           VALUE SPACES.\n               10 R1-05-YEAR              PIC X(2).\n               \n       01 R1-10-ENCABEZADOS-SEGUNDA-LINEA.\n           05 FILLER                      PIC X(24)       VALUE\n           \"DIV. PAQUETES\".\n           05 FILLER                      PIC X(10).\n           05 FILLER                      PIC X(15)       VALUE\n           \"P L A N T A\".\n           05 FILLER                      PIC X(5)        VALUE SPACES.\n           05 R1-10-DESCRIPCION-PTA       PIC X(30).\n           05 FILLER                      PIC X(22).\n           05 FILLER                      PIC X(5)        VALUE \"HOJA \".\n           05 R1-10-PAGNU                 PIC Z(4).\n\n       01 R1-15-ENCABEZADOS-TERCERA-LINEA.\n           05 FILLER                      PIC X           VALUE SPACES.\n           05 FILLER                      PIC X(12)       VALUE\n           \"CONTABILIDAD\".\n           05 FILLER                      PIC X(77)       VALUE SPACES.\n\n       01 R1-20-ENCABEZADOS-CUARTA-LINEA.\n           05 FILLER                      PIC X           VALUE SPACES.\n           05 FILLER                      PIC X(5)       VALUE\n           \"DPTO\".\n           05 FILLER                      PIC X(5).\n           05 R1-20-DPTO                  PIC X(6).\n           05 FILLER                      PIC XX         VALUE SPACES.\n           05 R1-20-DESCRIPCION-DPTO-ENCA PIC X(30).\n\n\n       01 R1-25-ENCABEZADOS-QUINTA-LINEA.\n           05 FILLER                      PIC X(15)       VALUE\n           \"P R O D U C T O\".\n           05 FILLER                      PIC X(30)       VALUE SPACE.\n           05 FILLER                      PIC X(15)       VALUE\n           \"REPORTO ALMACEN\".\n           05 FILLER                      PIC X(5)       VALUE SPACE.\n           05 FILLER                      PIC X(18)       VALUE\n           \"REPORTO PRODUCCION\".\n           05 FILLER                      PIC X(5)       VALUE SPACE.\n           05 FILLER                      PIC X(20)       VALUE\n           \"DIF. ENTRE REPORTES\".\n\n       01 R1-30-ENCABEZADOS-SEXTA-LINEA.\n           05 FILLER                      PIC X(6)        VALUE\n           \"CODIGO\".\n           05 FILLER                      PIC X(2)        VALUE SPACES.\n           05 FILLER                      PIC X(15)       VALUE\n           \"DESCRIPCION\".\n           05 FILLER                      PIC X(20)       VALUE SPACE.\n           05 FILLER                      PIC X(7)        VALUE\n           \"CONSUMO\".\n           05 FILLER                      PIC X(2)       VALUE SPACES.\n           05 FILLER                      PIC X(8)       VALUE\n           \"IMPORTE\".\n           05 FILLER                      PIC X(2)       VALUE SPACES.\n           05 FILLER                      PIC X(7)        VALUE\n           \"CONSUMO\".\n           05 FILLER                      PIC X(2)       VALUE SPACES.\n           05 FILLER                      PIC X(8)       VALUE\n           \"IMPORTE\".\n           05 FILLER                      PIC X(10)       VALUE SPACES.\n           05 FILLER                      PIC X(7)        VALUE\n           \"CONSUMO\".\n           05 FILLER                      PIC X(3)       VALUE SPACES.\n           05 FILLER                      PIC X(8)       VALUE\n           \"IMPORTE\".\n           05 FILLER                      PIC X(2)       VALUE SPACES.\n           05 FILLER                      PIC X(10)       VALUE\n           \"A FAVOR DE\".\n\n      *---\n      *Linea detalle\n      *---\n       01 R1-35-LINEADETALLE.\n           05 R1-35-PRINT-CODIGO          PIC X(6).\n           05 FILLER                      PIC X(1)        VALUE SPACES.\n           05 R1-35-PRINT-DESCRIPCION     PIC X(30).\n           05 FILLER                      PIC X(1)        VALUE SPACES.\n           05 R1-35-PRINT-COMSUMO-RA      PIC +ZZ,ZZZ,ZZ9.\n           05 FILLER                      PIC X(1)        VALUE SPACES.\n           05 R1-35-PRINT-IMPORTE-RA      PIC +ZZ,ZZZ,ZZ9.\n           05 FILLER                      PIC X(1)        VALUE SPACES.\n           05 R1-35-PRINT-COMSUMO-RP      PIC +ZZ,ZZZ,ZZ9.\n           05 FILLER                      PIC X(1)        VALUE SPACES.\n           05 R1-35-PRINT-IMPORTE-RP      PIC +ZZ,ZZZ,ZZ9.\n           05 FILLER                      PIC X(1)        VALUE SPACES.\n           05 R1-35-PRINT-COMSUMO-DIF     PIC ZZ,ZZZ,ZZ9.\n           05 FILLER                      PIC X(1)        VALUE SPACES.\n           05 R1-35-PRINT-IMPORTE-DIF     PIC ZZ,ZZZ,ZZ9.\n           05 FILLER                      PIC X(6)        VALUE SPACES.\n           05 R1-35-PRINT-MENSAJE-A-FAVOR PIC X(10).\n\n      *---\n      *Linea total de Dpto\n      *---\n       01 R1-40-TOTAL-POR-DPTO.\n           05 FILLER                      PIC X           VALUE SPACES.\n           05 FILLER                      PIC X(15)       VALUE\n           \"TOTAL DEL DPTO\".\n           05 FILLER                      PIC X(5).\n           05 R1-40-DPTO                  PIC X(6).\n           05 FILLER                      PIC XXX         VALUE SPACES.\n           05 R1-40-DESCRIPCION-DPTO      PIC X(30).\n           05 FILLER                      PIC X(77)       VALUE SPACES.\n      *---\n      *Linea total de almacen\n      *---\n       01 R1-45-TOTAL-POR-RA.\n           05 FILLER                      PIC X           VALUE SPACES.\n           05 FILLER                      PIC X(10)       VALUE\n           \"ALMACEN\".\n           05 FILLER                      PIC X(5).\n           05 FILLER                      PIC X(15)       VALUE\n           \"IMPORTE\".\n           05 FILLER                      PIC X(3)        VALUE SPACES.\n           05 R1-45-PRINT-IMPORTE-RA      PIC ZZ,ZZZ,ZZ9.99.\n           05 FILLER                      PIC X(3)        VALUE SPACES.\n           05 FILLER                      PIC X(20)       VALUE\n           \"DIFERENCIA A FAVOR\".\n           05 FILLER                      PIC X(3)        VALUE SPACES.\n           05 R1-45-PRINT-A-FAVOR-RA      PIC ZZ,ZZZ,ZZ9.99.\n           05 FILLER                      PIC X(20)       VALUE SPACES.\n      *---\n      *Linea total de produccion\n      *---\n\n       01 R1-50-TOTAL-POR-RP.\n           05 FILLER                      PIC X           VALUE SPACES.\n           05 FILLER                      PIC X(10)       VALUE\n           \"PRODUCCION\".\n           05 FILLER                      PIC X(5).\n           05 FILLER                      PIC X(15)       VALUE\n           \"IMPORTE\".\n           05 FILLER                      PIC X(3)        VALUE SPACES.\n           05 R1-50-PRINT-IMPORTE-RP      PIC ZZ,ZZZ,ZZ9.99.\n           05 FILLER                      PIC X(3)        VALUE SPACES.\n           05 FILLER                      PIC X(20)       VALUE\n           \"DIFERENCIA A FAVOR\".\n           05 FILLER                      PIC X(3)        VALUE SPACES.\n           05 R1-50-PRINT-A-FAVOR-RP      PIC ZZ,ZZZ,ZZ9.99.\n       PROCEDURE DIVISION.\n      *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-\n       000-CONTROL SECTION.\n       000-0100-INICIO.\n           OPEN INPUT ARCH-AC-ARCHIVO-CONSUMO.\n           MOVE 0 TO S000-FINARCHCONSUMO.\n           MOVE 1 TO S000-ESTADOARCHCONSUMO.\n\n           OPEN INPUT ARCH-AD-ARCHIVO-DEVOLUCION.\n           MOVE 0 TO S000-FINARCHDEVOLUCION.\n           MOVE 1 TO S000-ESTADOARCHDEVOLUCION.\n\n           OPEN OUTPUT REPO-R1-REPORTE.\n           MOVE 1 TO S000-ESTADOREPO.\n\n           MOVE ZEROS TO A990-CIFRAS-CONTROL.\n           MOVE W000-PROG TO R1-05-CONSPRO.\n       000-0200-REALIZA-FECHA.\n           PERFORM 010-FECHA.\n       000-0300-CARGA-TABLA-ARCH-TABLA.\n           PERFORM 020-CARGA-TABLA-ARCH-TABLA.\n       000-0400-CARGA-TABLA-ARCH-PROD.\n           PERFORM 030-CARGA-TABLA-ARCH-PRODUCTO.\n       000-0500-LEE-CONSUMO-DEVOLUCION.\n           MOVE LOW-VALUES TO I070-AC-ID-LEI-CONSUMO.\n           MOVE LOW-VALUES TO I110-AD-ID-LEI-DEVOLUCION.\n           PERFORM 070-LEE-REG-CONSUMO.\n           PERFORM 110-LEE-REG-DEVOLUCION.\n       000-0600-PROCESA-PTA.\n\n           PERFORM 040-PROC-PTA UNTIL (S000-FINARCHCONSUMO NOT = 0 AND\n               S000-FINARCHDEVOLUCION NOT = 0).\n       000-0700-CIFRAS-CONTROL.\n           PERFORM 990-CIFRAS-CONTROL.\n       000-0800-TERMINA.\n            CLOSE ARCH-AC-ARCHIVO-CONSUMO.\n            MOVE 0 TO S000-ESTADOARCHCONSUMO.\n            CLOSE ARCH-AD-ARCHIVO-DEVOLUCION.\n            MOVE 0 TO S000-ESTADOARCHDEVOLUCION.\n            CLOSE REPO-R1-REPORTE.\n            MOVE 0 TO S000-ESTADOREPO.\n       000-FIN.\n           GOBACK.\n\n\n       010-FECHA SECTION.\n       010-0100-INICIO.\n           OPEN INPUT ARCH-AF-ARCHIVO-FECHA.\n           MOVE 0 TO S000-FINARCHFECHA.\n           MOVE 1 TO S000-ESTADOARCHFECHA.\n\n           READ ARCH-AF-ARCHIVO-FECHA AT END MOVE 1\n           TO S000-FINARCHFECHA.\n           IF S000-FINARCHFECHA = 1 THEN\n               MOVE FUNCTION CURRENT-DATE(1:8) TO W000-FECHA\n           ELSE\n           IF RI-F-ACCESO NOT = 'F01' THEN\n               DISPLAY '          TERMINACION ANORMAL, CODIGO 16  '\n               PERFORM 980-ABORTA\n               END-IF.\n\n       010-0200-VALIDA-FECHA.\n           IF ((RI-F-COMP-YEAR>=0) AND (RI-F-MONTH>=1 AND\n               RI-F-MONTH<=12) AND (RI-F-DAY>=1\n               AND\n               (RI-F-MONTH = 2 AND ((((FUNCTION REM(RI-F-YEAR,400)=0 OR\n               (FUNCTION REM(RI-F-YEAR,4)=0 AND FUNCTION\n               REM(RI-F-YEAR,100) NOT =0))\n               AND\n               RI-F-DAY<30) OR ((FUNCTION REM(RI-F-YEAR,400) NOT =0 OR\n               (FUNCTION REM(RI-F-YEAR,4)NOT =0 AND FUNCTION\n               REM(RI-F-YEAR,100) =0)) AND RI-F-DAY <29))))))\n              THEN\n               MOVE RI-F-YEAR TO W000-YEAR\n               MOVE RI-F-MONTH TO W000-MONTH\n               MOVE RI-F-DAY TO W000-DAY\n               ELSE IF ((RI-F-COMP-YEAR>=0) AND (RI-F-MONTH>= 1 AND\n                   RI-F-MONTH<=12) AND (RI-F-DAY>=1 AND\n                   ((RI-F-MONTH = 04 OR RI-F-MONTH =06 OR RI-F-MONTH\n                   =09 OR RI-F-MONTH = 11) AND\n                 RI-F-DAY<=30 )))\n                 MOVE RI-F-COMP-YEAR TO W000-YEAR\n                 MOVE RI-F-MONTH TO W000-MONTH\n                 MOVE RI-F-DAY TO W000-DAY\n                 ELSE IF ((RI-F-COMP-YEAR>=0) AND (RI-F-MONTH>= 1 AND\n                   RI-F-MONTH<=12) AND (RI-F-DAY>=1 AND\n                   ((RI-F-MONTH = 01 OR RI-F-MONTH =03 OR RI-F-MONTH\n                   =05 OR RI-F-MONTH = 07 OR RI-F-MONTH = 08\n                   OR RI-F-MONTH = 10 OR RI-F-MONTH = 12) AND\n                 RI-F-DAY<=31 )))\n                 MOVE RI-F-COMP-YEAR TO W000-YEAR\n                 MOVE RI-F-MONTH TO W000-MONTH\n                 MOVE RI-F-DAY TO W000-DAY\n                 ELSE\n                   DISPLAY '          TERMINACION ANORMAL, CODIGO 16  '\n                   DISPLAY '          FECHA INVALIDA                  '\n                     PERFORM 980-ABORTA\n                 END-IF.\n\n            MOVE W000-DAY TO R1-05-DAY.\n            MOVE W000-YEAR TO R1-05-YEAR.\n            SET  T010-I TO W000-MONTH.\n            MOVE T010-MONTH(T010-I) TO R1-05-MONTH.\n            CLOSE ARCH-AF-ARCHIVO-FECHA.\n            MOVE 0 TO S000-ESTADOARCHFECHA.\n       010-0990-FIN.\n           EXIT.\n           \n           \n       020-CARGA-TABLA-ARCH-TABLA SECTION.\n           OPEN INPUT ARCH-AT-ARCHIVO-TABLA.\n           MOVE 0 TO S000-FINARCHTABLA.\n           MOVE 1 TO S000-ESTADOARCHTABLA.\n           MOVE 0 TO T020-NUM-ELEM-T04\n                     T020-NUM-ELEM-T05.\n           MOVE LOW-VALUES TO I080-AT-ID-LEI-TABLA.\n\n       020-0200-CHECA-CLAVE.\n           IF I080-CLAVE < 'T04' THEN\n               PERFORM 080-LEE-REG-TABLA\n\n           ELSE IF I080-CLAVE = 'T04' THEN\n               PERFORM 020-0300-T04-LEE\n               PERFORM 080-LEE-REG-TABLA\n\n\n           ELSE IF I080-CLAVE = 'T05' THEN\n               PERFORM 020-0400-T05-LEE\n               PERFORM 080-LEE-REG-TABLA\n               \n           ELSE\n               PERFORM 020-0600-FINAL\n               END-IF.\n       020-0300-T04-LEE.\n\n               ADD 1 TO T020-NUM-ELEM-T04\n               IF T020-NUM-ELEM-T04 > T020-MAX-ELEM-T04 THEN\n                   PERFORM 980-ABORTA\n                   ELSE\n                   SET T020-I-T04 TO T020-NUM-ELEM-T04\n                   MOVE I080-PTA TO T020-PTA-T04(T020-NUM-ELEM-T04)\n                   MOVE RI-T-DESCRIPCION TO\n                   T020-DESCRIPCION-T04(T020-NUM-ELEM-T04)\n                   END-IF.\n\n       020-0400-T05-LEE.\n               ADD 1 TO T020-NUM-ELEM-T05\n               IF T020-NUM-ELEM-T05 > T020-MAX-ELEM-T05 THEN\n                   PERFORM 980-ABORTA\n                   ELSE\n                   SET T020-I-T05 TO T020-NUM-ELEM-T05\n                   MOVE I080-PTA TO T020-PTA-T05(T020-I-T05)\n                   MOVE I080-DPTO TO T020-DPTO-T05(T020-I-T05)\n                   MOVE RI-T-DESCRIPCION TO\n                   T020-DESCRIPCION-T05(T020-I-T05)\n                   END-IF.\n       020-0500-LEE-TABLA.\n\n           PERFORM 020-0200-CHECA-CLAVE UNTIL S000-FINARCHTABLA = 1.\n       020-0600-FINAL.\n           CLOSE ARCH-AT-ARCHIVO-TABLA.\n           MOVE 0 TO S000-ESTADOARCHTABLA.\n      *    SET I-T05 TO 1.\n      * SEARCH T000-DETALLES-T05\n      *   AT END DISPLAY 'M NOT FOUND IN TABLE'\n      *   WHEN T000-CLAVE(I-T05)='DDDSSWWAA'\n      *   DISPLAY 'ENCONTRADO!'\n      * END-SEARCH.\n\n       020-990-FIN.\n           EXIT.\n\n       030-CARGA-TABLA-ARCH-PRODUCTO SECTION.\n       030-0100-INICIO.\n           OPEN INPUT ARCH-AP-ARCHIVO-PRODUCTO.\n           MOVE 0 TO S000-FINARCHPRODUCTO.\n           MOVE 1 TO S000-ESTADOARCHPRODUCTO.\n           MOVE 0 TO T030-NUM-ELEM-PR.\n           MOVE LOW-VALUES TO I100-AP-ID-LEI-PRODUCTO.\n\n       030-0200-COPIA.\n\n           ADD 1 TO T030-NUM-ELEM-PR\n               IF T030-NUM-ELEM-PR > T030-MAX-ELEM-PR THEN\n                   PERFORM 980-ABORTA\n                   ELSE\n                   SET T030-I-PR TO T030-NUM-ELEM-PR\n\n                   MOVE I100-CODIGO TO T030-CODIGO(T030-NUM-ELEM-PR)\n                   MOVE RI-P-CTO TO T030-CTO(T030-NUM-ELEM-PR)\n                   MOVE RI-P-DESCRIPCION TO\n                   T030-DESCRIPCION(T030-NUM-ELEM-PR)\n                   \n                   END-IF.\n                   PERFORM 100-LEE-REG-PRODUCTO.\n\n               \n       030-0300-LEE-TABLA.\n\n           PERFORM 030-0200-COPIA UNTIL S000-FINARCHPRODUCTO = 1.\n       030-0400-TERMINA.\n           CLOSE ARCH-AP-ARCHIVO-PRODUCTO.\n           MOVE 0 TO S000-ESTADOARCHPRODUCTO.\n\n\n       030-FIN.\n           EXIT.\n\n       040-PROC-PTA SECTION.\n       040-0100-INICIO.\n           IF I070-AC-ID-PTA-CONS < I110-AD-ID-PTA-DEV THEN\n               MOVE I070-AC-ID-PTA-CONS TO I040-ID-PROC-PTA-CONS\n               ELSE\n                   MOVE I110-AD-ID-PTA-DEV TO I040-ID-PROC-PTA-CONS\n                   END-IF.\n       040-0200-BUSCA-EN-TABLA.\n          SET T020-I-T04-I TO 1.\n          SEARCH T020-DETALLES-T04\n         AT END MOVE SPACES TO R1-10-DESCRIPCION-PTA\n         WHEN T020-PTA-T04(T020-I-T04-I)=I040-ID-PROC-PTA-CONS\n         MOVE T020-DESCRIPCION-T04(T020-I-T04-I) TO\n         R1-10-DESCRIPCION-PTA\n       END-SEARCH.\n       040-0300-INICIA-FOLIO.\n           MOVE 0 TO R1-NUM-HOJA.\n       040-0400-PROCESA-DPTO.\n           PERFORM 050-PROC-DPTO UNTIL ((I040-ID-PROC-PTA-CONS NOT =\n               I070-AC-ID-PTA-CONS) AND (I040-ID-PROC-PTA-CONS NOT =\n               I110-AD-ID-PTA-DEV)).\n       040-0500-CIFRA-CONTROL.\n           ADD 1 TO A990-PROC-PTA.\n       040-FIN.\n           EXIT.\n       050-PROC-DPTO SECTION.\n       050-0100-INICIO.\n           IF I070-AC-ID-DPTO-CONS < I110-AD-ID-DPTO-DEV THEN\n               MOVE I070-AC-ID-DPTO-CONS TO I040-ID-PROC-DPTO-CONS\n               ELSE\n                   MOVE I110-AD-ID-DPTO-DEV TO I040-ID-PROC-DPTO-CONS\n                   END-IF.\n                   MOVE I040-DPTO TO R1-40-DPTO.\n                   MOVE I040-DPTO TO R1-20-DPTO.\n       050-0200-BUSCA-EN-TABLA.\n           \n          SET T020-I-T05-I TO 1.\n          SEARCH T020-DETALLES-T05\n         AT END MOVE SPACES TO R1-20-DESCRIPCION-DPTO-ENCA\n         MOVE SPACES TO R1-40-DESCRIPCION-DPTO\n         WHEN T020-CLAVE(T020-I-T05-I)=I040-ID-PROC-DPTO-CONS\n         MOVE T020-DESCRIPCION-T05(T020-I-T05-I) TO\n         R1-20-DESCRIPCION-DPTO-ENCA\n         MOVE T020-DESCRIPCION-T05(T020-I-T05-I) TO\n         R1-40-DESCRIPCION-DPTO\n       END-SEARCH.\n       050-0300-INICIALIZA-ACUM.\n           MOVE R1-MAX-LIN TO R1-NUM-LIN.\n           MOVE ZEROES TO A050-ACUMULADOR-RA.\n           MOVE ZEROES TO A050-ACUMULADOR-RP.\n       050-0400-PROCESA-REGISTRO.\n           PERFORM 060-PROC-REG UNTIL ((I040-ID-PROC-DPTO-CONS NOT =\n               I070-AC-ID-DPTO-CONS) AND (I040-ID-PROC-DPTO-CONS NOT =\n               I110-AD-ID-DPTO-DEV)).\n       050-0500-ENCABEZADOS.\n           IF (R1-NUM-LIN + 7) > R1-MAX-LIN THEN\n               PERFORM 090-ENCABEZADOS\n               ADD 7 TO R1-NUM-LIN\n               END-IF.\n       050-0600-ESCRIBE-TOTAL-POR-DPTO.\n\n              MOVE A050-ACUM-TOTAL-IMPORTE-RA TO R1-45-PRINT-IMPORTE-RA.\n              MOVE A050-ACUM-TOTAL-IMPORTE-RP TO R1-50-PRINT-IMPORTE-RP.\n              MOVE A050-ACUM-A-FAVOR-RA TO R1-45-PRINT-A-FAVOR-RA.\n              MOVE A050-ACUM-A-FAVOR-RP TO R1-50-PRINT-A-FAVOR-RP.\n              WRITE R1-COMPARACION FROM R1-40-TOTAL-POR-DPTO AFTER 3.\n              WRITE R1-COMPARACION FROM R1-45-TOTAL-POR-RA AFTER 2.\n              WRITE R1-COMPARACION FROM R1-50-TOTAL-POR-RP AFTER 2.\n              ADD 7 TO R1-NUM-LIN.\n              ADD 1 TO A990-PROC-DPTO.\n\n       050-FIN.\n           EXIT.\n       060-PROC-REG SECTION.\n       060-0100-INICIO.\n           MOVE ZEROES TO A060-ACUMULADOR-RA-REG.\n           MOVE ZEROES TO A060-ACUMULADOR-RP-REG.\n           MOVE ZEROES TO A060-ACUMULADOR-DEVUELTO.\n           MOVE ZEROES TO A060-ACUMULADOR-DIFERENCIA.\n       060-0200-DECIDE-PRODUCTO.\n           IF I070-AC-ID-CODIGO-CONS < I110-AD-ID-CODIGO-DEV THEN\n               MOVE I070-AC-ID-CODIGO-CONS TO I040-ID-PROC-CODIGO-CONS\n               ELSE\n                   MOVE I110-AD-ID-CODIGO-DEV TO\n                   I040-ID-PROC-CODIGO-CONS\n                   END-IF.\n       060-0300-BUSCA-PRODUCTO.\n          SET T030-I-PRODUCTO TO 1.\n\n          SEARCH T030-DETALLES-PRODUCTOS\n          AT END DISPLAY '          TERMINACION ANORMAL, CODIGO 16  '\n          DISPLAY '          PRODUCTO NO ENCONTRADO         '\n          PERFORM 980-ABORTA\n\n           WHEN T030-CODIGO (T030-I-PRODUCTO)=I040-CODIGO\n           MOVE T030-CODIGO(T030-I-PRODUCTO) TO R1-35-PRINT-CODIGO\n           MOVE T030-DESCRIPCION(T030-I-PRODUCTO)TO\n           R1-35-PRINT-DESCRIPCION\n           MOVE T030-CTO(T030-I-PRODUCTO) TO W050-COSTO\n       END-SEARCH.\n\n       060-0400-RA-RP.\n           IF RI-C-CVE = 'RA' THEN\n               ADD RI-C-CANT-CONSUMO TO A060-ACUM-REG-RA-CONSUMO.\n               IF RI-C-CVE = 'RP' THEN\n                   ADD RI-C-CANT-CONSUMO TO A060-ACUM-REG-RP-CONSUMO\n                   END-IF.\n                   PERFORM 070-LEE-REG-CONSUMO.\n       060-0500-PROCESA-PRODUCTO-CONS.\n                PERFORM 060-0400-RA-RP\n               UNTIL I040-ID-PROC-CODIGO-CONS NOT =\n               I070-AC-ID-CODIGO-CONS.\n               \n       060-0600-CALCULA-DEV.\n           ADD RI-D-CANT-DEVUELTA TO A060-ACUM-DEV.\n           PERFORM 110-LEE-REG-DEVOLUCION.\n\n       060-0700-DEVOLUCION.\n               PERFORM 060-0600-CALCULA-DEV UNTIL\n                   I040-ID-PROC-CODIGO-CONS NOT = I110-AD-ID-CODIGO-DEV.\n\n       060-0800-CALCULA-REG.\n\n           SUBTRACT A060-ACUM-DEV FROM A060-ACUM-REG-RA-CONSUMO.\n\n           MULTIPLY W050-COSTO BY A060-ACUM-REG-RA-CONSUMO\n           GIVING A060-ACUM-REG-RA-IMPORTE.\n           ADD A060-ACUM-REG-RA-IMPORTE TO A050-ACUM-TOTAL-IMPORTE-RA.\n           MOVE A060-ACUM-REG-RA-CONSUMO TO R1-35-PRINT-COMSUMO-RA.\n           MOVE A060-ACUM-REG-RA-IMPORTE TO R1-35-PRINT-IMPORTE-RA.\n           MULTIPLY W050-COSTO BY A060-ACUM-REG-RP-CONSUMO\n           GIVING A060-ACUM-REG-RP-IMPORTE.\n           ADD A060-ACUM-REG-RP-IMPORTE TO A050-ACUM-TOTAL-IMPORTE-RP.\n           MOVE A060-ACUM-REG-RP-CONSUMO TO R1-35-PRINT-COMSUMO-RP.\n           MOVE A060-ACUM-REG-RP-IMPORTE TO R1-35-PRINT-IMPORTE-RP.\n           SUBTRACT A060-ACUM-REG-RP-IMPORTE FROM\n               A060-ACUM-REG-RA-IMPORTE GIVING A060-ACUM-DIF-IMPORTE.\n           SUBTRACT A060-ACUM-REG-RP-CONSUMO FROM\n               A060-ACUM-REG-RA-CONSUMO GIVING A060-ACUM-DIF-CONSUMO.\n           MOVE A060-ACUM-DIF-IMPORTE TO R1-35-PRINT-IMPORTE-DIF.\n           MOVE A060-ACUM-DIF-CONSUMO TO R1-35-PRINT-COMSUMO-DIF.\n\n           IF A060-ACUM-REG-RA-CONSUMO > A060-ACUM-REG-RP-CONSUMO THEN\n               ADD A060-ACUM-DIF-IMPORTE TO A050-ACUM-A-FAVOR-RA\n               MOVE 'ALMACEN' TO R1-35-PRINT-MENSAJE-A-FAVOR\n               \n               ADD 1 TO A990-PROC-A-FAVOR-RA\n               ELSE IF A060-ACUM-REG-RA-CONSUMO <\n                   A060-ACUM-REG-RP-CONSUMO THEN\n                   ADD A060-ACUM-DIF-IMPORTE TO A050-ACUM-A-FAVOR-RP\n                   ADD 1 TO A990-PROC-A-FAVOR-RP\n                   MOVE 'PRODUCCION' TO R1-35-PRINT-MENSAJE-A-FAVOR\n                   ELSE\n                       MOVE SPACES TO R1-35-PRINT-MENSAJE-A-FAVOR\n                       ADD 1 TO A990-PROC-EMPATE\n                       END-IF.\n               IF (R1-NUM-LIN + 1) > R1-MAX-LIN THEN\n                 PERFORM 090-ENCABEZADOS\n                 ADD 1 TO R1-NUM-LIN\n                 END-IF.\n\n       060-0900-ESCRIBE-DETALLE.\n               WRITE R1-COMPARACION FROM R1-35-LINEADETALLE AFTER 1.\n               ADD 1 TO R1-NUM-LIN.\n               ADD 1 TO A990-PROC-REG.\n       060-0990-FIN.\n           EXIT.\n\n       070-LEE-REG-CONSUMO SECTION.\n       070-0100-INICIO.\n           MOVE I070-AC-ID-LEI-CONSUMO TO I070-AC-ID-ANT.\n\n       070-0200-LEE-ARCHIVO.\n           READ ARCH-AC-ARCHIVO-CONSUMO AT END MOVE 1\n           TO S000-FINARCHCONSUMO.\n           IF S000-FINARCHCONSUMO = 1\n           THEN\n               MOVE HIGH-VALUES TO I070-AC-ID-LEI-CONSUMO\n           ELSE\n               MOVE RI-C-PTA TO I070-PTA\n               MOVE RI-C-DPTO TO I070-DPTO\n               MOVE RI-C-CODIGO TO I070-CODIGO.\n               ADD 1 TO A990-PROC-LEIDO-CONSUMO.\n\n       070-0300-ABORTA.\n           IF I070-AC-ID-LEI-CONSUMO < I070-AC-ID-ANT\n           THEN\n               MOVE 16 TO RETURN-CODE\n               DISPLAY '            ARCHIVO CONSUMO               '\n      -        'FUERA DE SECUENCIA     '\n               DISPLAY '          ID. ANT. ('  I070-AC-ID-ANT '  )'\n               DISPLAY\n               '          ID. LEI. ('  I070-AC-ID-LEI-CONSUMO '  )'\n               DISPLAY '          TERMINACION ANORMAL, CODIGO 16  '\n               PERFORM 980-ABORTA.\n       070-990-FIN.\n           EXIT.\n\n       080-LEE-REG-TABLA SECTION.\n       080-0100-INICIO.\n           MOVE I080-AT-ID-LEI-TABLA TO I080-AT-ID-ANT.\n\n       080-0200-LEE-ARCHIVO.\n           READ ARCH-AT-ARCHIVO-TABLA AT END MOVE 1\n           TO S000-FINARCHTABLA.\n           IF S000-FINARCHTABLA = 1\n           THEN\n               MOVE HIGH-VALUES TO I080-AT-ID-LEI-TABLA\n           ELSE\n               MOVE RI-T-CVE TO I080-CLAVE\n               MOVE RI-T-PTA TO I080-PTA\n               MOVE RI-T-DPTO TO I080-DPTO\n               ADD 1 TO A990-PROC-LEIDO-TABLA.\n\n       080-0300-ABORTA.\n           IF I080-AT-ID-LEI-TABLA < I080-AT-ID-ANT\n           THEN\n               MOVE 16 TO RETURN-CODE\n               DISPLAY '            ARCHIVO TABLA                 '\n      -        'FUERA DE SECUENCIA     '\n               DISPLAY '          ID. ANT. ('  I080-AT-ID-ANT '  ) '\n               DISPLAY\n               '          ID. LEI. ('  I080-AT-ID-LEI-TABLA '  )  '\n               DISPLAY '          TERMINACION ANORMAL, CODIGO 16  '\n               PERFORM 980-ABORTA.\n       080-990-FIN.\n           EXIT.\n\n       090-ENCABEZADOS SECTION.\n       090-0100-INICIO.\n           ADD 1 TO R1-NUM-HOJA.\n           MOVE R1-NUM-HOJA TO R1-10-PAGNU.\n\n           WRITE R1-COMPARACION FROM R1-05-ENCABEZADOS-PRIMERA-LINEA\n           AFTER PAGE.\n           WRITE R1-COMPARACION FROM R1-10-ENCABEZADOS-SEGUNDA-LINEA\n           AFTER 2.\n           WRITE R1-COMPARACION FROM R1-15-ENCABEZADOS-TERCERA-LINEA\n           AFTER 1.\n           WRITE R1-COMPARACION FROM R1-20-ENCABEZADOS-CUARTA-LINEA\n           AFTER 2.\n           WRITE R1-COMPARACION FROM R1-25-ENCABEZADOS-QUINTA-LINEA\n           AFTER 2.\n           WRITE R1-COMPARACION FROM R1-30-ENCABEZADOS-SEXTA-LINEA\n           AFTER 1.\n           WRITE R1-COMPARACION FROM ' ' AFTER 1.\n           MOVE 10 TO R1-NUM-LIN.\n       090-990-FIN.\n           EXIT.\n       \n       100-LEE-REG-PRODUCTO SECTION.\n       100-0100-INICIO.\n           MOVE I100-AP-ID-LEI-PRODUCTO TO I100-AP-ID-ANT.\n\n       100-0200-LEE-ARCHIVO.\n           READ ARCH-AP-ARCHIVO-PRODUCTO AT END MOVE 1\n           TO S000-FINARCHPRODUCTO.\n           IF S000-FINARCHPRODUCTO = 1\n           THEN\n               MOVE HIGH-VALUES TO I100-AP-ID-LEI-PRODUCTO\n           ELSE\n               MOVE RI-P-CODIGO TO I100-CODIGO\n               ADD 1 TO A990-PROC-LEIDO-PRODUCTO.\n\n       100-0300-ABORTA.\n           IF I100-AP-ID-LEI-PRODUCTO < I100-AP-ID-ANT\n           THEN\n               MOVE 16 TO RETURN-CODE\n               DISPLAY '            ARCHIVO PRODUCTO              '\n      -        'FUERA DE SECUENCIA     '\n               DISPLAY '          ID. ANT. ('  I100-AP-ID-ANT '  )'\n               DISPLAY\n               '          ID. LEI. ('  I100-AP-ID-LEI-PRODUCTO '  )'\n               DISPLAY '          TERMINACION ANORMAL, CODIGO 16  '\n               PERFORM 980-ABORTA.\n       100-990-FIN.\n           EXIT.\n\n       110-LEE-REG-DEVOLUCION SECTION.\n       110-0100-INICIO.\n           MOVE I110-AD-ID-LEI-DEVOLUCION TO I110-AD-ID-ANT.\n\n       110-0200-LEE-ARCHIVO.\n           READ ARCH-AD-ARCHIVO-DEVOLUCION AT END MOVE 1 \n           TO S000-FINARCHDEVOLUCION.\n           IF S000-FINARCHDEVOLUCION = 1\n           THEN\n               MOVE HIGH-VALUES TO I110-AD-ID-LEI-DEVOLUCION\n           ELSE\n               MOVE RI-D-PTA TO I110-PTA\n               MOVE RI-D-DPTO TO I110-DPTO\n               MOVE RI-D-CODIGO TO I110-CODIGO.\n               ADD 1 TO A990-PROC-LEIDO-DEVOLUCION.\n\n       110-0300-ABORTA.\n           IF I110-AD-ID-LEI-DEVOLUCION < I110-AD-ID-ANT\n           THEN\n               MOVE 16 TO RETURN-CODE\n               DISPLAY '            ARCHIVO DEVOLUCION            '\n      -        'FUERA DE SECUENCIA     '\n               DISPLAY '          ID. ANT. ('  I110-AD-ID-ANT '  )'\n               DISPLAY \n               '          ID. LEI. ('  I110-AD-ID-LEI-DEVOLUCION '  )'\n               DISPLAY '          TERMINACION ANORMAL, CODIGO 16  '\n               PERFORM 980-ABORTA.\n       110-990-FIN.\n           EXIT.\n\n\n       980-ABORTA SECTION.\n              980-0100-INICIO.\n           IF S000-ESTADOARCHCONSUMO NOT = 0\n           THEN\n               CLOSE ARCH-AC-ARCHIVO-CONSUMO\n               MOVE 1 TO S000-ESTADOARCHCONSUMO.\n           IF S000-ESTADOARCHDEVOLUCION NOT = 0\n           THEN\n               CLOSE ARCH-AD-ARCHIVO-DEVOLUCION\n               MOVE 1 TO S000-ESTADOARCHDEVOLUCION.\n           IF S000-ESTADOARCHPRODUCTO NOT = 0\n               THEN\n               CLOSE ARCH-AP-ARCHIVO-PRODUCTO\n               MOVE 1 TO S000-ESTADOARCHPRODUCTO.\n            IF S000-ESTADOARCHTABLA NOT = 0\n               THEN\n               CLOSE ARCH-AT-ARCHIVO-TABLA\n               MOVE 1 TO S000-ESTADOARCHTABLA.\n           IF S000-ESTADOARCHFECHA NOT = 0\n           THEN\n               CLOSE ARCH-AF-ARCHIVO-FECHA\n               MOVE 0 TO S000-ESTADOARCHFECHA.\n           IF S000-ESTADOREPO NOT = 0\n               THEN\n               CLOSE REPO-R1-REPORTE\n               MOVE 1 TO S000-ESTADOREPO.\n           PERFORM 990-CIFRAS-CONTROL.\n           MOVE 16 TO RETURN-CODE.\n       980-FIN.\n           GOBACK.\n\n       990-CIFRAS-CONTROL SECTION.\n       DISPLAY W000-PROG '  CON.S LEIDOS\n      -    '           ' A990-PROC-LEIDO-CONSUMO   .\n       DISPLAY W000-PROG '  DEV.S LEIDOS\n      -    '           ' A990-PROC-LEIDO-DEVOLUCION   .\n       DISPLAY W000-PROG '  PLANTAS PROCESADAS\n      -    '           ' A990-PROC-PTA.\n       DISPLAY W000-PROG '  DEPARTAMENTOS PROCESADOS\n      -    '           ' A990-PROC-DPTO.\n       DISPLAY W000-PROG '  PROCESOS PROCESADOS\n      -    '           ' A990-PROC-REG.\n       DISPLAY W000-PROG '  REG.S A FAVOR DE ALMACEN\n      -    '           ' A990-PROC-A-FAVOR-RA.\n       DISPLAY W000-PROG '  REG.S A FAVOR DE PRODUCCION\n      -    '           ' A990-PROC-A-FAVOR-RP.\n       DISPLAY W000-PROG '  REG.S A FAVOR DE NINGUNO\n      -    '           ' A990-PROC-EMPATE.\n       990-FIN.\n           EXIT.\n"
  },
  "input_files": [],
  "output_files": [],
  "input_output_files": [],
  "sysin_file": null
}