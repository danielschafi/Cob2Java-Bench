{
  "cobol_file": {
    "file_name": "successful_snippet_d6e303bb.cob",
    "content": "\n      ******************************************************************\n      *  Batch1 \n      *\n      ******************************************************************\n       IDENTIFICATION              DIVISION.\n      ******************************************************************\n       PROGRAM-ID.                 BATCH_2.\n       AUTHOR.                     UCA\n       DATE-WRITTEN.               20201502\n      ******************************************************************\n       ENVIRONMENT DIVISION. \n      ******************************************************************\n       INPUT-OUTPUT SECTION.\n        FILE-CONTROL.\n           SELECT TRANSACTIONS ASSIGN TO 'transactions.txt'\n           ORGANIZATION IS SEQUENTIAL.\n           SELECT VISIT_FILE ASSIGN TO 'data.txt'\n           ORGANIZATION IS SEQUENTIAL.\n \n      ******************************************************************\n       DATA                        DIVISION.\n      ******************************************************************\n       FILE SECTION.\n       FD TRANSACTIONS.\n       01 VISIT-STRUCT.\n         02 IP.\n           03 IP_1 PIC 9(3).\n           03 SEP1 PIC X(1) VALUE '.'.\n           03 IP_2 PIC 9(3).\n           03 SEP2 PIC X(1) VALUE '.'.\n           03 IP_3 PIC 9(3).\n           03 SEP3 PIC X(1) VALUE '.'.\n           03 IP_4 PIC 9(3).\n           03 DATA1_f PIC X(5).\n         02 VISIT_DATE.\n           03 VDAY PIC X(2).\n           03 FILLER PIC X(1).\n           03 VMONTH PIC X(3).\n           03 FILLER PIC X(1).\n           03 VYEAR PIC X(4).\n         02 VISITED_STR PIC X(10).\n         02 TIMES_VISIT PIC 9(5).\n        \n         02 LINE-FEED  PIC X.\n       FD VISIT_FILE.\n        01 INPUT-RECORD    PIC X(51).\n\n\n      ******************************************************************\n       WORKING-STORAGE             SECTION.\n      ******************************************************************\n       77 OCC_G PIC 999999.\n\n       01 VISIT-STRUCT-final.\n        02 VISIT_info  OCCURS 5000 times.\n           03 ID_IP.\n            04 IP_f.\n              05 IP_1_f PIC 9(3).\n              05 FILLER PIC X(1).\n              05 IP_2_f PIC 9(3).\n              05 FILLER PIC X(1).\n              05 IP_3_f PIC 9(3).\n              05 FILLER PIC X(1).\n              05 IP_4_f PIC 9(3).\n            04 DATA1_f PIC X(5).\n            04 VISIT_DATE_TAB_f.\n              05 VDAY_f PIC X(2).\n              05 FILLER PIC X(1).\n              05 FILLER PIC X(1).\n              05 VMONTH_f PIC X(3).\n              05 FILLER PIC X(1).\n              05 VYEAR_f PIC X(4).\n           03 VISITED_STR_f PIC X(10).\n           03 TIMES_VISIT_f PIC 9(5).   \n           03 LINE-FEED_f  PIC X.\n\n       01 TABLE_VISIT.\n        02 VISIT-STRUCT_TAB OCCURS 5000 times.\n         03 IP_TAB.\n           04 IP_1_TAB PIC 9(3).\n           04 filler PIC X(1).\n           04 IP_2_TAB PIC 9(3).\n           04 filler PIC X(1).\n           04 IP_3_TAB PIC 9(3).\n           04 filler PIC X(1).\n           04 IP_4_TAB PIC 9(3).\n         03 DATA1 PIC X(5).\n         03 VISIT_DATE_TAB.\n           04 VDAY_TAB PIC X(2).\n           04 filler PIC X(1).\n           04 VMONTH_TAB PIC X(3).\n           04 filler PIC X(1).\n           04 VYEAR_TAB PIC X(4).       \n \n       01 WS-CURRENT-DATE-DATA.\n        05  WS-CURRENT-DATE.\n           10  WS-CURRENT-YEAR         PIC 9(04).\n           10  WS-CURRENT-MONTH        PIC 9(02).\n           10  WS-CURRENT-DAY          PIC 9(02).\n       05  WS-CURRENT-TIME.\n           10  WS-CURRENT-HOURS        PIC 9(02).\n           10  WS-CURRENT-MINUTE       PIC 9(02).\n           10  WS-CURRENT-SECOND       PIC 9(02).\n           10  WS-CURRENT-MILLISECONDS PIC 9(02).\n\n       77 END-OF-FILE PIC Z(1). \n       77 TEMP_A PIC X(50). \n       77 TEMP_B PIC X(100).\n       77 TEMP_C PIC X(100).\n       77 TEMP_D PIC X(100).\n       77 NUM PIC 9(5) VALUE 0.\n\n       77 OCC PIC 999999.\n\n       77 OCC2 PIC 999999.\n       77 OCC3 PIC 999999.\n       77 NB_ELT PIC 999999  VALUE 1.\n       77 IND PIC 999999 VALUE 0.\n\n       77 NO_FIND-IND              PIC X          VALUE \"N\".\n       77 EOF-IND              PIC X          VALUE \"N\".\n\n       01 WS-EOF-SW PIC X(01) VALUE 'N'.\n           88 EOF-SW VALUE 'Y'.\n           88 NOT-EOF-SW VALUE 'Y'.\n       PROCEDURE                   DIVISION.\n      ******************************************************************\n\n       MAIN-RTN.\n           DISPLAY \"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\".\n           DISPLAY \"! BATCH 1   :                                    !\".\n           DISPLAY \"! TRAITEMENT BACH STATISTIQUES VISITES           !\".\n           DISPLAY \"! AUTHOR : ULYSSE CADOUR                         !\".\n           DISPLAY \"!                                                !\".\n           DISPLAY \"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\". \n           DISPLAY \"!            _           _                       !\"\n           DISPLAY \"!           | |         | |                      !\"           \n           DISPLAY \"!   ___ ___ | |__   ___ | |                      !\"\n           DISPLAY \"!  / __/ _ \\| '_ \\ / _ \\| |                      !\"\n           DISPLAY \"! | (_| (_) | |_) | (_) | |                      !\"\n           DISPLAY \"!  \\___\\___/|_.__/ \\___/|_|                      !\"\n           DISPLAY \"!                                                !\"\n           DISPLAY \"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\". \n\n\n       MAIN-EXT.\n\n           PERFORM 000-TRT-FONC001\n              THRU 000-TRT-FONC001-FIN.\n           PERFORM 000-TRT-FONC002\n              THRU 000-TRT-FONC002-FIN.\n           PERFORM 300-ECRITURE-FICHIER.\n\n           DISPLAY \"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\".\n           DISPLAY \"! END BATCH COOL RUN MAN :-)                     !\".\n           DISPLAY \"!                                                !\".\n           DISPLAY \"!                                                !\".\n           DISPLAY \"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\". \n\n           STOP RUN.\n\n\n       000-TRT-FONC001.\n             MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE-DATA\n             DISPLAY \"! CURRENT DATE : \" WS-CURRENT-DATE-DATA\n      \t      \"                !\"\n\n             OPEN INPUT VISIT_FILE\n      \n                MOVE 0 to OCC\n      \n             PERFORM READ-FILE UNTIL EOF-IND = \"Y\".\n      \n             \n     \n             \n               \n      \n                \n       000-TRT-FONC001-FIN.\n\n       300-ECRITURE-FICHIER.\n           OPEN OUTPUT TRANSACTIONS                                \n           PERFORM TEST AFTER VARYING  \n           OCC2 FROM 1 BY 1 UNTIL OCC2 = NB_ELT \n              \n              MOVE VISIT_info(OCC2) TO VISIT-STRUCT\n              MOVE X'0A' TO LINE-FEED\n            Move ' VISITED :' TO VISITED_STR\n            MOVE '.' TO SEP1\n            MOVE '.' TO SEP2\n            MOVE '.' TO SEP3\n            WRITE VISIT-STRUCT\n           END-PERFORM.\n \n\n       READ-FILE.\n             READ VISIT_FILE\n             AT END\n             MOVE \"Y\" TO EOF-IND.\n\n             UNSTRING INPUT-RECORD DELIMITED BY\n             \" \" INTO TEMP_A TEMP_B TEMP_C TEMP_D\n             UNSTRING TEMP_A DELIMITED BY \".\"\n             INTO  IP_1 IP_2 IP_3 IP_4 \n            \n             UNSTRING TEMP_D DELIMITED BY \"[\"\n             INTO TEMP_B  TEMP_C\n             UNSTRING TEMP_C  DELIMITED BY \"]\"\n             INTO TEMP_D TEMP_C\n                \n             MOVE TEMP_D TO  VISIT_DATE\n             ADD 1 to NUM\n             MOVE X'0A' TO LINE-FEED.\n      \n             MOVE VISIT-STRUCT  TO  VISIT-STRUCT_TAB(OCC) \n               ADD 1 to OCC.\n             \n       \n      \n       000-TRT-FONC002.\n           MOVE 0 TO NB_ELT\n           MOVE OCC to OCC_G\n\n\n           \n             PERFORM TEST AFTER VARYING \n             OCC2 FROM 1 BY 1 UNTIL \n             OCC2 >= OCC_G \n               PERFORM  000-FIND_ID\n               PERFORM 00-ANALYSE-FIND\n           \t          \n             \n             END-PERFORM.\n\n       \n          \n       000-TRT-FONC002-FIN.\n\n\n\n       000-FIND_ID.\n           MOVE \"N\" TO NO_FIND-IND\n           MOVE 0 TO OCC3\n           PERFORM TEST AFTER VARYING\n              OCC3 FROM 0 BY 1 UNTIL OCC3 = NB_ELT \n              OR  NO_FIND-IND NOT =\"N\"\n        \n               IF IP_TAB(OCC2)=IP_f(OCC3) \n                THEN\n                 MOVE \"Y\" TO NO_FIND-IND\n               END-IF\n           END-PERFORM.\n        \n        00-ANALYSE-FIND.\n              if NO_FIND-IND NOT = \"Y\"\n              THEN\n              DISPLAY \"! FIND IP \"IP_TAB(OCC2)\n               \"                           !\"\n               MOVE IP_TAB(OCC2)\n               TO IP_f(NB_ELT)\n               MOVE VISIT_DATE_TAB(OCC2)\n               TO VISIT_DATE_TAB_f(NB_ELT)\n               MOVE X'0A' TO LINE-FEED_f(NB_ELT)\n               ADD 1 TO NB_ELT\n               ADD 2 TO TIMES_VISIT_f(NB_ELT)\n           else \n           ADD 1 TO TIMES_VISIT_f(OCC3)\n\n           END-IF.\n           EXIT. "
  },
  "input_files": [
    {
      "file_name": "data.txt",
      "content": "123 456 789 01 12 JAN 2023\n456 789 123 02 15 FEB 2023\n789 123 456 03 20 MAR 2023\n123 456 789 04 25 APR 2023\n456 789 123 05 30 MAY 2023\n789 123 456 06 05 JUN 2023\n123 456 789 07 10 JUL 2023\n456 789 123 08 15 AUG 2023\n789 123 456 09 20 SEP 2023\n123 456 789 10 25 OCT 2023"
    }
  ],
  "output_files": [
    "transactions.txt"
  ],
  "input_output_files": [],
  "sysin_file": null
}