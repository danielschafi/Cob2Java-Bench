{
  "cobol_file": {
    "file_name": "successful_snippet_82d0f806.cob",
    "content": "       IDENTIFICATION DIVISION.\n       PROGRAM-ID. AOC-2020-14-1.\n       AUTHOR ANNA KOSIERADZKA.\n      \n       ENVIRONMENT DIVISION.\n       INPUT-OUTPUT SECTION.\n       FILE-CONTROL.\n           SELECT INPUTFILE ASSIGN TO \"d14.input\"\n           ORGANIZATION IS LINE SEQUENTIAL.\n           \n       DATA DIVISION.\n       FILE SECTION.\n         FD INPUTFILE\n         RECORD IS VARYING IN SIZE FROM 1 to 99\n         DEPENDING ON REC-LEN.\n         01 INPUTRECORD PIC X(99).\n         \n       WORKING-STORAGE SECTION.\n         01 FILE-STATUS PIC 9 VALUE 0.\n         01 REC-LEN PIC 9(2) COMP.\n         01 WS-MASK PIC X(36).\n         01 WS-ADDR PIC 9(12).\n         01 WS-VAL PIC 9(12).\n         01 WS-VAL-DEC PIC 9(12) VALUE 0.\n         01 WS-VAL-BIN PIC X(36) VALUE SPACE.\n         01 WS-MEM PIC 9(12) VALUE 0 OCCURS 65536 TIMES.\n         01 RESULT PIC 9(16) VALUE 0.\n         77 WS-D PIC 9.\n        \n       LOCAL-STORAGE SECTION.\n         01 I UNSIGNED-INT VALUE 0.\n\n       PROCEDURE DIVISION.\n       001-MAIN.\n           OPEN INPUT INPUTFILE.\n           PERFORM 002-READ UNTIL FILE-STATUS = 1.\n           CLOSE INPUTFILE.\n           PERFORM SUM-MEMORY.\n           DISPLAY RESULT.\n           STOP RUN.\n\n       002-READ.\n            READ INPUTFILE\n                AT END MOVE 1 TO FILE-STATUS\n                NOT AT END PERFORM 003-PROCESS-RECORD\n            END-READ.\n       \n       003-PROCESS-RECORD.\n           IF INPUTRECORD(1:4) = \"mask\" THEN \n              MOVE INPUTRECORD(8:36) TO WS-MASK\n           ELSE \n              UNSTRING INPUTRECORD(5:36) DELIMITED BY \"=\" INTO \n                 WS-ADDR WS-VAL\n               MOVE WS-VAL TO WS-VAL-DEC\n               PERFORM DEC-TO-BIN\n               PERFORM APPLY-MASK\n               PERFORM BIN-TO-DEC\n               MOVE WS-VAL-DEC TO WS-MEM(WS-ADDR)\n           END-IF.\n\n       APPLY-MASK.\n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 36\n              IF NOT WS-MASK(I:1) = 'X' THEN \n                 MOVE WS-MASK(I:1) TO WS-VAL-BIN (I:1)\n              END-IF\n           END-PERFORM.\n\n       DEC-TO-BIN.\n           MOVE SPACE TO WS-VAL-BIN.\n           PERFORM VARYING I FROM 36 BY -1 UNTIL I = 0\n              DIVIDE WS-VAL-DEC BY 2 GIVING WS-VAL-DEC REMAINDER WS-D\n              MOVE WS-D TO WS-VAL-BIN(I:1)\n           END-PERFORM.\n\n       BIN-TO-DEC.\n           MOVE 0 TO WS-VAL-DEC.\n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 36\n              COMPUTE WS-VAL-DEC = WS-VAL-DEC * 2\n              IF WS-VAL-BIN(I:1) = 1 THEN \n                 COMPUTE WS-VAL-DEC = WS-VAL-DEC + 1\n              END-IF\n           END-PERFORM.\n\n       SUM-MEMORY.\n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 65536\n              ADD WS-MEM(I) TO RESULT\n           END-PERFORM.\n"
  },
  "input_files": [
    {
      "file_name": "d14.input",
      "content": "000000000010000000002\nA1B1C10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    }
  ],
  "output_files": [],
  "input_output_files": [],
  "sysin_file": null
}